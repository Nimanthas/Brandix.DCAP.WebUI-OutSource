@{
    Layout = "_Layout";
}

<script type="text/javascript">
    var selectedDate = null;
    var fromdatePicker = null;
    var todatePicker = null;
    var scheduleObject = null;
    var operationList = null;
    var todayDate = null;
    var scrapItems = [];
    var SoberSheetMode = false;
    var SSheetSCHNo = null;
    var SSheetSCHId = null;
    var SSAlreadySaved = false;
    var clie6

    //views
    var createNewTag = null;
    var manageTag = null;
    var addItemsGrid = null;
    var isvalidbarcode = false;

    var TotalQty = 0;
    var TotalQtyO = 0;

    var rowDataItem = null;
    var travelcode = null;

    var clickedbutton = 0;
    var expandedTableWindow = null;

    var scannedBarcode = null;
    var scannedBarcodeo = null;

    var deleted = "";
    var deletedo = "";

    getSessionInfo();

    $(document).ready(function () {
        $('#sitebody').removeClass('body-login');
        $("#sitebody").append(
            '<div id="ajaxBusy" class="ajaxBusy"></div>'
        );
        $("#ajaxBusy").hide();
        checkLoginStatus();
        $('#pageTitleBar').html('<i class="fas fa-barcode pageMainIcon"></i><span class="pageTitle">DCap - Travel/Buddy Tag</span>');

        initializeControls();

        checkIdle();

        if (isValidClient == Answer.Null) {
            window.location.href = "Login";
        }
        else if (isValidClient != null && clientconfig.dataCaptureMode != DataCaptureMode.Bulk) {
            if (clientconfig.dataCaptureMode == DataCaptureMode.Barcode) {
                msgBox.show('මෙම යන්ත්‍රයට බල්ක් අප්ඩේට් කිරීම සඳහා අවසර නැත.', 'This device is not authorized for Bulk update', 'අවවාදයයි / Warning', 'BU01', 'Warning', function () {
                    if (clientconfig.dataCaptureMode == DataCaptureMode.Washing) {
                        window.location.href = "Menu";
                    }
                });
            }
        }
    });

    function checkLoginStatus() {
        if (sessionStorage.getItem("UserId") != "") {
            $("#toolBarLoggedinUser").html(sessionStorage.getItem("UserId"));
        } else {
            $("#toolBarLoggedinUser").html("");
        }
        if (sessionStorage.getItem("IsSignedIn") == Answer.Null || sessionStorage.getItem("IsSignedIn") == Answer.No) {
            $("#loginBar").hide();
            window.location.href = "Login";
        } else {
            $("#loginBar").show();
        }
    }

    function initializeControls() {
        DisableInputs();

        if (true) {//userPermissionList.some(permission => permission.functionId === AccessibleDispatchFunctions.GenerateTravelBarcode)
            $("#createNewTTag").show();
        } else {
           $("#createNewTTag").hide(); 
        }

        //console.log(sessionStorage, JSON.parse(sessionStorage.getItem("Clientconfig"))),
        //Data selectors
        $("#date-created-filter").kendoDatePicker({format:"yyyy-MM-dd",min:new Date(1900,0,1,0,0,0,0),max:new Date(2099,11,31,0,0,0,0)});
        $("#allocation-date").kendoDatePicker({format:"yyyy-MM-dd",min:new Date(1900,0,1,0,0,0,0),max:new Date(2099,11,31,0,0,0,0)});
        $("#allocation-date-o").kendoDatePicker({format:"yyyy-MM-dd",min:new Date(1900,0,1,0,0,0,0),max:new Date(2099,11,31,0,0,0,0)});
        $("#planned-date").kendoDateTimePicker({dateInput: true, format:"yyyy-MM-dd HH:mm:ss",min:new Date(1900,0,1,0,0,0,0),max:new Date(2099,11,31,0,0,0,0)});
        $("#planned-date-o").kendoDateTimePicker({dateInput: true, format:"yyyy-MM-dd HH:mm:ss",min:new Date(1900,0,1,0,0,0,0),max:new Date(2099,11,31,0,0,0,0)});

        todayDate = new Date();
        $("#date-created-filter").data("kendoDatePicker").value(todayDate);
        $("#allocation-date").data("kendoDatePicker").value(todayDate);
        $("#allocation-date-o").data("kendoDatePicker").value(todayDate);
        $("#planned-date").data("kendoDateTimePicker").value(todayDate);
        $("#planned-date-o").data("kendoDateTimePicker").value(todayDate);
        
	    $("#status-filter").kendoDropDownList({"dataSource":[{"Text":"All","Value":"0"},
                                                            {"Text":"Production Pending","Value":"1"},
                                                            {"Text":"Production Started","Value":"2"},
                                                            {"Text":"Production Finished","Value":"3"},
                                                            {"Text":"Dispatched","Value":"4"}],
                                                "dataTextField":"Text","dataValueField":"Value"});

        $("#mode-filter").kendoDropDownList({"dataSource":[{"Text":"All","Value":"0"},
                                                            {"Text":"Travel Tag","Value":"2"},
                                                            {"Text":"Buddy Tag","Value":"3"}],
                                                "dataTextField":"Text","dataValueField":"Value"});
        //End of data selections
        //Create new Travel tag : START
        resetBagBarcodeFields();

        //Add all garments shortcut
        shortcut.add("F5", function () {
            allocateFromBagBarcode();
        });

        //Split and Add garments shortcut
        shortcut.add("F6", function () {
            openAddItemWindow();
        });

        //Add all garments shortcut
        shortcut.add("F9", function () {
            allocateFromBagBarcodeOutSource();
        });

        //Split and Add garments shortcut
        shortcut.add("F10", function () {
            openAddItemWindow();
        });

        $("#bag-barcode-text").keydown(function (e) {
            if (e.keyCode == 13) {
                if ($('#bag-barcode-text').val() != ""){
                    loadBagBarcodeDetails();
                    return;         
                }   
            }
        });

        $("#allocated-qty-from-bag-o").keydown(function (e) {
            if (e.keyCode == 13) {
                allocateFromBagBarcodeOutSource();
                return; 
            }
        });

        $("#bag-barcode-text-o").keydown(function (e) {
            if (e.keyCode == 13) {
                if ($('#bag-barcode-text-o').val() != ""){
                    loadBagBarcodeDetailsOutSource();
                    return;         
                }   
            }
        });

        $("#allocation-barcode-text").keydown(function (e) {
            if (e.keyCode == 13) {
                if ($('#allocation-barcode-text').val() != ""){
                    proccedAllocation();
                    return;         
                }   
            }
        });

        $("#TravelBarcode").keydown(function (e) {
            if (e.keyCode == 13) {
                RefreshRequestGrid();
            }
        });
        //Create new Travel tag : END

        //For Request loading
        //Grid definit      ion
        $("#traveltag-grid").kendoGrid({
            toolbar: ["pdf", "excel"],
            pdf: {
                allPages: true,
                author: JSON.parse(sessionStorage.getItem("Clientconfig")).clientId,
                creator: JSON.parse(sessionStorage.getItem("Clientconfig")).clientId,
                date: (new Date()).toLocaleDateString('en-US', { month: '2-digit', day: '2-digit', year: 'numeric'}),
                fileName: "request summary"
            },
            excel: {
                allPages: true,
                fileName: "travel-tag-summary.xlsx",
                filterable: true
            },
            dataSource: {
                schema: {
                    model: {
                        fields: {
                            TravelBarCodeNo: { type: "string", editable: false },
                            BarcodeType: { type: "string", editable: false },
                            TravelStatus: { type: "string", editable: false },
                            Status: { type: "string", editable: false },
                            Qty01: { type: "number", editable: false },
                            JobQty: { type: "number", editable: false },
                            Weight: { type: "number", editable: false },
                            TrollyNo: { type: "string", editable: false },
                            AllocationDate: { type: "date",editable: true },
                            Remarks: { type: "string",editable: true },
                            CreatedDateTime: { type: "date",editable: true },
                            CreatedBy: { type: "string",editable: true },
                        },
                    }
                },
                batch: true,
                pageSize: 5,
            },
            scrollable: true,
            dataBound: OnGridDataBound,        
            sortable: true,
            filterable: true,
            pageable: true,
            pageable: {
                    pageSizes: true,
                    buttonCount: 10
                },
            columns:[
                        {title:"BarCode",field:"TravelBarCodeNo",width:"180px"},
                        {title:"Type",field:"BarcodeType",width:"120px", template: "#if (BarcodeType == 2 ) {# <div class='mb-2 mr-2 badge badge-success'>Travel Tag" + 
                        "</div> #} else if (BarcodeType == 3){ # <div class='mb-2 mr-2 badge badge-warning'>Buddy Tag" +
                        "</div> #}#" },
                        {title:"Travel Status",field:"TravelStatus",width:"200px"},// template: "<div class='mb-2 mr-2 badge badge-primary'>#Status#" + 
                            //"</div>" },
                        {title:"Print",field:"Status",width:"200px", filterable: false,encoded:true, template: "#if (parseInt(Status) == 151) {# <div><button id='printGatePassRequestButton' class='k-button print-request-status' style='width: 90%; height: 36px; border-radius: 13px; margin-left: 10px;' onclick='setButtonStatus(1)'><span class='k-icon k-i-print' style='margin-right: 7px; text-align:left;'></span><span>Print</span></button>" + 
                        "</div> #} else { # <div style='text-align: center;''><button id='printGatePassRequestButton' class='k-button print-request-status' style='width: 90%; height: 36px; border-radius: 13px;' onclick='setButtonStatus(1)'><span class='k-icon k-i-print' style='margin-right: 7px; text-align:left;'></span><span>Print (Copy)</span></button>" + 
                        "</div> #}#" },
                        {title:"Quantity",field:"Qty01",width:"120px",encoded:true},
                        {title:"Job Quantity",field:"JobQty",width:"120px",encoded:true},
                        {title:"Weight (Kg)",field:"Weight",width:"120px",encoded:true},
                        {title:"Trolly No/ Ref. No.",field:"TrollyNo",width:"180px",encoded:true},
                        {title:"Allocation Date",field:"AllocationDate",width:"160px",format:"{0:dd-MM-yyyy hh:mm:ss}",filterable:{operators:{date:{gte:"From",lte:"To"}}},encoded:true},
                        {title:"Remarks",field:"Remarks",width:"280px",encoded:true},
                        {title:"Created Date Time",field:"CreatedDateTime",width:"180px",encoded:true},
                        {title:"Created By",field:"CreatedBy",width:"180px",encoded:true},
                    ],
        });

        //new tag Item Grid Initilize
        $("#bag-barcode-details-table").kendoGrid({
            dataSource: {
                schema: {
                    model: {
                        id: "Bag_Barcode",
                        fields: {
                            Seq: { type: "number", editable: false },
                            Wfid: { type: "number", editable: false },
                            WfInstid: { type: "number", editable: false },
                            Depid: { type: "number", editable: false },
                            Barcode: { type: "string", editable: false },
                            Mode: { type: "number", editable: false },
                            Bag_Barcode: { type: "string", editable: false },
                            Style: { type: "string", editable: false },
                            L1: { type: "number", editable: false },
                            Shedule: { type: "string", editable: false },
                            PO: { type: "string", editable: false },
                            Z_Feature: { type: "string", editable: false },
                            L2: { type: "number", editable: false },
                            L3: { type: "number", editable: false },
                            Color: { type: "string", editable: false },
                            L4: { type: "number", editable: false },
                            L5: { type: "number", editable: false },
                            Bag_Quantity: { type: "number", editable: false },
                            Allocate_Quantity: { type: "number", editable: true },
                            Remarks: { editable: true }
                        },
                    }
                },
                batch: true,
                aggregate: [{ field: "Bag_Quantity", aggregate: "sum" },{ field: "Allocate_Quantity", aggregate: "sum" }]
            },
            navigatable: true,
            scrollable: true,   
            sortable: true,
            filterable: true,
            columns: [
                { field: "Seq", title: "Seq", width: "110px", hidden:true },
                { field: "Wfid", title: "Wfid", width: "110px", hidden:true },
                { field: "WfInstid", title: "WfInstid", width: "110px", hidden:true },
                { field: "Depid", title: "Depid", width: "110px", hidden:true },
                { field: "Barcode", title: "Barcode", width: "140px" },
                { field: "Mode", title: "Mode", width: "90px", template: "#if (Mode == '0' ) {# <div>Garment" + 
                                "</div> #} else if (Mode == '1'){ # <div>Bag" +
                                "</div> #}#" },
                { field: "Bag_Barcode", title: "Ref. Bag Barcode", width: "140px" },
                { field: "Style", title: "Style", width: "100px" },
                { field: "L1", title: "L1", width: "100px", hidden:true },
                { field: "Shedule", title: "Shedule", width: "115px" },
                { field: "PO", title: "PO", width: "100px" },
                { field: "Z_Feature", title: "Z-Feature", width: "125px" },
                { field: "L2", title: "L2", width: "100px", hidden:true },
                { field: "L3", title: "L3", width: "100px", hidden:true },
                { field: "Color", title: "Color", width: "110px", footerTemplate: "Total" },
                { field: "L4", title: "L4", width: "100px", hidden:true },
                { field: "L5", title: "L5", width: "100px", hidden:true },
                { field: "Bag_Quantity", title: "Quantity", width: "120px", aggregates: ["sum"], groupFooterTemplate: "#=sum#", footerTemplate: "#=sum#"},
                { field: "Allocate_Quantity", title: "Allocated Qty", width: "120px", aggregates: ["sum"], groupFooterTemplate: "#=sum#", footerTemplate: "#=sum#" },
                { field: "Remarks", title: "Remarks" },
                { command: [{ name: "Delete", imageClass: "k-icon k-i-close", click: function (e) {
                        e.preventDefault();
                        var dataItem = this.dataItem($(e.target).closest("tr"));
                        if (confirm('Do you really want to delete this record?')) {
                            var dataSource = $("#bag-barcode-details-table").data("kendoGrid").dataSource;
                            TotalQty = TotalQty - dataItem.Allocate_Quantity;
                            $("#current-quantitiy-text").html(TotalQty);
                            $("#remaining-quantitiy-text").html(parseInt($("#job-quantity-text").val()) - TotalQty);
                            deleted = dataItem.Barcode;
                            //console.log(TotalQty);
                            dataSource.remove(dataItem);
                            dataSource.sync();
                        }
                    }
                }], title: "&nbsp;", width: "120px" },

            ],
            editable: "inline"
        });

        //new tag Item Grid Initilize
        $("#bag-barcode-details-table-o").kendoGrid({
            dataSource: {
                schema: {
                    model: {
                        id: "Bag_Barcode",
                        fields: {
                            Seq: { type: "number", editable: false },
                            Wfid: { type: "number", editable: false },
                            WfInstid: { type: "number", editable: false },
                            Depid: { type: "number", editable: false },
                            Barcode: { type: "string", editable: false },
                            Mode: { type: "number", editable: false },
                            Bag_Barcode: { type: "string", editable: false },
                            Style: { type: "string", editable: false },
                            L1: { type: "number", editable: false },
                            Shedule: { type: "string", editable: false },
                            PO: { type: "string", editable: false },
                            Z_Feature: { type: "string", editable: false },
                            L2: { type: "number", editable: false },
                            L3: { type: "number", editable: false },
                            Color: { type: "string", editable: false },
                            L4: { type: "number", editable: false },
                            L5: { type: "number", editable: false },
                            Size: { type: "number", editable: false },
                            Bag_Quantity: { type: "number", editable: false },
                            Allocate_Quantity: { type: "number", editable: true },
                            Remarks: { editable: true }
                        },
                    }
                },
                batch: true,
                aggregate: [{ field: "Bag_Quantity", aggregate: "sum" },{ field: "Allocate_Quantity", aggregate: "sum" }]
            },
            navigatable: true,
            scrollable: true,   
            sortable: true,
            filterable: true,
            columns: [
                { field: "Seq", title: "Seq", width: "110px", hidden:true },
                { field: "Wfid", title: "Wfid", width: "110px", hidden:true },
                { field: "WfInstid", title: "WfInstid", width: "110px", hidden:true },
                { field: "Depid", title: "Depid", width: "110px", hidden:true },
                { field: "Barcode", title: "Barcode", width: "140px" },
                { field: "Mode", title: "Mode", width: "90px", template: "#if (Mode == '0' ) {# <div>Garment" + 
                                "</div> #} else if (Mode == '1'){ # <div>Bag" +
                                "</div> #}#" },
                { field: "Bag_Barcode", title: "Ref. Bag Barcode", width: "140px" },
                { field: "Style", title: "Style", width: "100px" },
                { field: "L1", title: "L1", width: "100px", hidden:true },
                { field: "Shedule", title: "Shedule", width: "115px" },
                { field: "PO", title: "PO", width: "100px" },
                { field: "Z_Feature", title: "Z-Feature", width: "125px" },
                { field: "L2", title: "L2", width: "100px", hidden:true },
                { field: "L3", title: "L3", width: "100px", hidden:true },
                { field: "Color", title: "Color", width: "110px" },
                { field: "L4", title: "L4", width: "100px", hidden:true },
                { field: "L5", title: "L5", width: "100px", hidden:true },
                { field: "Size", title: "Size", width: "110px", footerTemplate: "Last Added Qty" },
                { field: "Bag_Quantity", title: "Quantity", width: "120px", aggregates: ["sum"], groupFooterTemplate: "#=sum#", footerTemplate: "#=sum#"},
                { field: "Allocate_Quantity", title: "Allocated Qty", width: "120px", aggregates: ["sum"], groupFooterTemplate: "#=sum#", footerTemplate: "#=sum#" },
                { field: "Remarks", title: "Remarks" },
                { command: [{ name: "Delete", imageClass: "k-icon k-i-close", click: function (e) {
                        e.preventDefault();
                        var dataItem = this.dataItem($(e.target).closest("tr"));
                        if (confirm('Do you really want to delete this record?')) {
                            var dataSource = $("#bag-barcode-details-table-o").data("kendoGrid").dataSource;
                            TotalQtyO = TotalQtyO - dataItem.Allocate_Quantity; 
                            $("#current-quantitiy-text-o").html(TotalQtyO);
                            $("#remaining-quantitiy-text-o").html(parseInt($("#job-quantity-text-o").val()) - TotalQtyO);
                            //console.log(TotalQtyO);
                            deletedo = dataItem.Barcode;
                            dataSource.remove(dataItem);
                            dataSource.sync();
                        }
                    }
                }], title: "&nbsp;", width: "120px" },

            ],
            editable: "inline"
        });

        //Start of Expanded Window Item Grid
        $("#expand-items-grid").kendoGrid({
            dataSource: {
                schema: {
                    model: {
                        id: "Key",
                        fields: {
                            Key: { type: "string", editable: false },
                            Seq: { type: "number", editable: false },
                            Wfid: { type: "number", editable: false },
                            WfInstid: { type: "number", editable: false },
                            Depid: { type: "number", editable: false },
                            Barcode: { type: "string", editable: false },
                            Mode: { type: "number", editable: false },
                            Bag_Barcode: { type: "string", editable: false },
                            Style: { type: "string", editable: false },
                            L1: { type: "number", editable: false },
                            Shedule: { type: "string", editable: false },
                            PO: { type: "string", editable: false },
                            Z_Feature: { type: "string", editable: false },
                            L2: { type: "number", editable: false },
                            L3: { type: "number", editable: false },
                            Color: { type: "string", editable: false },
                            L4: { type: "number", editable: false },
                            L5: { type: "number", editable: false },
                            Bag_Quantity: { type: "number", editable: false },
                            Allocate_Quantity: { type: "number", editable: true },
                            Remarks: { editable: true }
                        },
                    }
                },
                batch: true,
                group: {
                            field: "Key", aggregates: [
                                { field: "Style", aggregate: "count" },
                                { field: "Bag_Quantity", aggregate: "sum"},
                                { field: "Allocate_Quantity", aggregate: "sum"},
                                { field: "Key", aggregate: "count" }
                            ]
                        },
                aggregate: [ { field: "Style", aggregate: "count" },
                             { field: "Bag_Quantity", aggregate: "sum" },
                             { field: "Allocate_Quantity", aggregate: "sum" },
                             { field: "Key", aggregate: "min" },
                             { field: "Key", aggregate: "max" }]
            },
            navigatable: true,
            scrollable: true,   
            sortable: true,
            filterable: true,
            columns: [
                { field:"Key",width:"0px", hidden: true , aggregates: ["count"], groupHeaderTemplate: "#= value # (Count: #= count#)" },
                { field: "Seq", title: "Seq", width: "110px", hidden:true },
                { field: "Wfid", title: "Wfid", width: "110px", hidden:true },
                { field: "WfInstid", title: "WfInstid", width: "110px", hidden:true },
                { field: "Depid", title: "Depid", width: "110px", hidden:true },
                { field: "Barcode", title: "Barcode", width: "140px" },
                { field: "Mode", title: "Mode", width: "90px", template: "#if (Mode == '0' ) {# <div>Garment" + 
                                "</div> #} else if (Mode == '1'){ # <div>Bag" +
                                "</div> #}#" },
                { field: "Bag_Barcode", title: "Ref. Bag Barcode", width: "140px" },
                { field: "Style", title: "Style", width: "100px" },
                { field: "L1", title: "L1", width: "100px", hidden:true },
                { field: "Shedule", title: "Shedule", width: "115px" },
                { field: "PO", title: "PO", width: "100px" },
                { field: "Z_Feature", title: "Z-Feature", width: "125px" },
                { field: "L2", title: "L2", width: "100px", hidden:true },
                { field: "L3", title: "L3", width: "100px", hidden:true },
                { field: "Color", title: "Color", width: "110px", footerTemplate: "Total", groupFooterTemplate: "Sub Total" },
                { field: "L4", title: "L4", width: "100px", hidden:true },
                { field: "L5", title: "L5", width: "100px", hidden:true },
                { field: "Bag_Quantity", title: "Quantity", width: "120px", aggregates: ["sum"], groupFooterTemplate: "#=sum#", footerTemplate: "#=sum#"},
                { field: "Allocate_Quantity", title: "Allocated Qty", width: "120px", aggregates: ["sum"], groupFooterTemplate: "#=sum#", footerTemplate: "#=sum#" },
                { field: "Remarks", title: "Remarks" }

            ],
            editable: "inline"
        });
        //End of Expanded Window Item Grid

        //Start of Expanded Window Item Grid
        $("#expand-items-grid-o").kendoGrid({
            dataSource: {
                schema: {
                    model: {
                        id: "Key",
                        fields: {
                            Key: { type: "string", editable: false },
                            Seq: { type: "number", editable: false },
                            Wfid: { type: "number", editable: false },
                            WfInstid: { type: "number", editable: false },
                            Depid: { type: "number", editable: false },
                            Barcode: { type: "string", editable: false },
                            Mode: { type: "number", editable: false },
                            Bag_Barcode: { type: "string", editable: false },
                            Style: { type: "string", editable: false },
                            L1: { type: "number", editable: false },
                            Shedule: { type: "string", editable: false },
                            PO: { type: "string", editable: false },
                            Z_Feature: { type: "string", editable: false },
                            L2: { type: "number", editable: false },
                            L3: { type: "number", editable: false },
                            Color: { type: "string", editable: false },
                            L4: { type: "number", editable: false },
                            L5: { type: "number", editable: false },
                            Size: { type: "number", editable: false },
                            Bag_Quantity: { type: "number", editable: false },
                            Allocate_Quantity: { type: "number", editable: true },
                            Remarks: { editable: true }
                        },
                    }
                },
                batch: true,
                group: {
                            field: "Key", aggregates: [
                                { field: "Style", aggregate: "count" },
                                { field: "Bag_Quantity", aggregate: "sum"},
                                { field: "Allocate_Quantity", aggregate: "sum"},
                                { field: "Key", aggregate: "count" }
                            ]
                        },
                aggregate: [ { field: "Style", aggregate: "count" },
                             { field: "Bag_Quantity", aggregate: "sum" },
                             { field: "Allocate_Quantity", aggregate: "sum" },
                             { field: "Key", aggregate: "min" },
                             { field: "Key", aggregate: "max" }]
            },
            navigatable: true,
            scrollable: true,   
            sortable: true,
            filterable: true,
            columns: [
                { field:"Key",width:"0px", hidden: true , aggregates: ["count"], groupHeaderTemplate: "#= value # (Count: #= count#)" },
                { field: "Seq", title: "Seq", width: "110px", hidden:true },
                { field: "Wfid", title: "Wfid", width: "110px", hidden:true },
                { field: "WfInstid", title: "WfInstid", width: "110px", hidden:true },
                { field: "Depid", title: "Depid", width: "110px", hidden:true },
                { field: "Barcode", title: "Barcode", width: "140px" },
                { field: "Mode", title: "Mode", width: "90px", template: "#if (Mode == '0' ) {# <div>Garment" + 
                                "</div> #} else if (Mode == '1'){ # <div>Bag" +
                                "</div> #}#" },
                { field: "Bag_Barcode", title: "Ref. Bag Barcode", width: "140px" },
                { field: "Style", title: "Style", width: "100px" },
                { field: "L1", title: "L1", width: "100px", hidden:true },
                { field: "Shedule", title: "Shedule", width: "115px" },
                { field: "PO", title: "PO", width: "100px" },
                { field: "Z_Feature", title: "Z-Feature", width: "125px" },
                { field: "L2", title: "L2", width: "100px", hidden:true },
                { field: "L3", title: "L3", width: "100px", hidden:true },
                { field: "Color", title: "Color", width: "110px" },
                { field: "L4", title: "L4", width: "100px", hidden:true },
                { field: "L5", title: "L5", width: "100px", hidden:true },
                { field: "Size", title: "Size", width: "110px", footerTemplate: "Total", groupFooterTemplate: "Sub Total" },
                { field: "Bag_Quantity", title: "Quantity", width: "120px", aggregates: ["sum"], groupFooterTemplate: "#=sum#", footerTemplate: "#=sum#"},
                { field: "Allocate_Quantity", title: "Allocated Qty", width: "120px", aggregates: ["sum"], groupFooterTemplate: "#=sum#", footerTemplate: "#=sum#" },
                { field: "Remarks", title: "Remarks" }

            ],
            editable: "inline"
        });
        //End of Expanded Window Item Grid

        EnableInputs();
    }

    function setButtonStatus(n) {
        clickedbutton = n;
    }

    function OnGridDataBound(e) {
        var grid = $("#traveltag-grid").data().kendoGrid; 
        var gridData = grid.dataSource.view();

        for (var i = 0; i < gridData.length; i++) {
            var currentUid = gridData[i].uid;
            if (gridData[i].success == true) {
                var currentRow = grid.table.find("tr[data-uid='" + currentUid + "']");
                currentRow.css('background-color', 'lightgreen');
            }
        }

        var grid = e.sender;
        var rows = grid.tbody.find("[role='row']");

        rows.unbind("click");
        rows.on("click", onClick)
    }

    function onClick(e) {
        if ($(e.target).hasClass("k-checkbox-label")) {
            return;
        }
        var row = $(e.target).closest("tr");

        var grid = $("#traveltag-grid").data().kendoGrid; 
        rowDataItem = grid.dataItem(row);

        if(clickedbutton == 1) {
            openPrintWindow();
        }

        var checkbox = $(row).find(".k-checkbox");

        checkbox.click();

        clickedbutton = 0;
    };
    //end

    function RefreshRequestGrid() {
        DisableInputs();
            $("#traveltag-grid").data('kendoGrid').dataSource.data([]);
            var gridData = [];
            var wfid = JSON.parse(sessionStorage.getItem("Clientconfig")).wfdepinstId;
            var status = $("#status-filter").data("kendoDropDownList").value();
            var mode = $("#mode-filter").data("kendoDropDownList").value();
            var todate = $("#date-created-filter").val();
            
            if (todate != "") {
                todate + "%2000:00:00";
            } else {
                todate = "0001-01-01%2000:00:00"
            }
            //console.log(todate);
            var travelbarcode = $("#TravelBarcode").val();

            $.ajax({
                url: '@ViewBag.APIURL/Lookup/GetTravelTagDetails?todate=' + todate + '&travelbarcodeno=' + travelbarcode + '&status=' + status + '&mode=' + mode,
                type: 'GET',
                dataType: 'json',
                //async: false,
                contentType: 'application/json',
                beforeSend: function () {
                    $("#ajaxBusy").show();
                },
                complete: function () {
                    $("#ajaxBusy").hide();
                },
                success: function (response) {
                    //console.log(response);
                    if(response.length != 0){
                        $.each(response, function (index, elements) {
                            var object = {
                                TravelBarCodeNo: elements.travelBarCodeNo,
                                BarcodeType: elements.txnMode,
                                TravelStatus: elements.travelStatus,
                                Status: elements.status,
                                Qty01: elements.qty01,
                                JobQty: elements.jobQty,
                                Weight: elements.weight,
                                TrollyNo: elements.trollyNo,
                                AllocationDate: formatDate(elements.allocationDate),
                                Remarks: elements.remarks,
                                CreatedDateTime: elements.createdDateTime.replace(/T/g, " "),
                                CreatedBy: elements.createdBy,
                            }
                            gridData.push(object);
                        });

                        $("#traveltag-grid").data('kendoGrid').dataSource.data(gridData);
                    } else {
                        msgBox.show('ප්‍රතිපලයක් හමු නොවීය.', 'no result was found.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
                    }
                    EnableInputs();
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    formatErrorMessage(jqXHR, errorThrown, "GenerateTravelBarcode");
                    EnableInputs();
                }
            });
    }

    function getSessionInfo() {
        isValidClient = sessionStorage.getItem("IsValidClient");
        clientconfig = JSON.parse(sessionStorage.getItem("Clientconfig"));
        userPermissionList = JSON.parse(sessionStorage.getItem("UserPermissionList"));
        clientIP = sessionStorage.getItem("ClientIP");
    }

    //CREATE NEW TAG
    function opencreateNewTag() {
        TotalQty = 0;
        $("#current-quantitiy-text").html(TotalQty);
        $("#remaining-quantitiy-text").html(parseInt($("#job-quantity-text").val()) - TotalQty);
        $("#color-code-dropdown").kendoDropDownList({"dataSource":[{"Text":"Green","Value":"0"},
                                                            {"Text":"Red","Value":"1"},
                                                            {"Text":"Yellow","Value":"2"},
                                                            {"Text":"Blue","Value":"3"},
                                                            {"Text":"Pink","Value":"3"}],
                                                            "dataTextField":"Text","dataValueField":"Value","optionLabel": "Select a color code..."});


        createNewTag = $("#createNewTag").kendoWindow({
            width: "95%",
            title: "Create new travel tag",
            visible: false,
            actions: ["Close"],
            close: function(e) {clickedbutton = 0;},
            modal: true,
            resizable: false,
            draggable: true,
            pinned: true,
        }).data("kendoWindow");

        var arrows = [38, 40];
        
        resetControllers();
        createNewTag.open().center();
    }

    //CREATE NEW OUTSOURCE TAG
    function opencreateNewTagOutSource() {
        //msgBox.show('' , 'under development.', 'Warning', 'BU05', 'Warning', null);
        
        //Create new outsorce travel tag : START
        //resetControllers();
        TotalQtyO = 0;
        $("#current-quantitiy-text-o").html(TotalQtyO);
        $("#remaining-quantitiy-text-o").html(parseInt($("#job-quantity-text-o").val()) - TotalQtyO);
        $("#color-code-dropdown-o").kendoDropDownList({"dataSource":[{"Text":"Green","Value":"0"},
                                                            {"Text":"Red","Value":"1"},
                                                            {"Text":"Yellow","Value":"2"},
                                                            {"Text":"Blue","Value":"3"},
                                                            {"Text":"Pink","Value":"3"}],
                                                            "dataTextField":"Text","dataValueField":"Value","optionLabel": "Select a color code..."});


        createNewTag = $("#createNewOutSourceTag").kendoWindow({
            width: "95%",
            title: "Create new travel tag (Outsource)",
            visible: false,
            actions: ["Close"],
            close: function(e) {clickedbutton = 0;},
            modal: true,
            resizable: false,
            draggable: true,
            pinned: true,
        }).data("kendoWindow");

        var arrows = [38, 40];
        
        resetControllers();
        createNewTag.open().center();
        
    }

    //MANAGE TRAVEL TAG
    function openmanageTag() {
        msgBox.show('' , 'under development.', 'Warning', 'BU05', 'Warning', null);
        /*
       manageTag = $("#manageTag").kendoWindow({
            width: "95%",
            title: "Manage travel tag",
            visible: false,
            actions: ["Close"],
            close: function(e) {clickedbutton = 0;},
            modal: true,
            resizable: false,
            draggable: true,
            pinned: true,
        }).data("kendoWindow"); 

        var arrows = [38, 40];
        
        resetControllers();
        manageTag.open().center();
        */
    }

    //Controllers
    function ValidateInputs() { //need to check
        var departmentTo = null;

        departmentTo = $("#departmentTo").data("kendoDropDownList").value();

        if(departmentTo != null) {
            $("#open-request-item-window-button").removeAttr("disabled");
        } else {
            $('#open-request-item-window-button').attr("disabled", "disabled");
        }
    }

    function validateCreateRequest(){
        var jobQuantity = null;
        var weight = null;
        var TrollyNo = null;
        var plannedDate = null;
        var plannedMachine = null;

        $("#job-quantity-text").removeClass("invalid-input");
        $("#weight-text").removeClass("invalid-input");
        $("#trolly-number-text").removeClass("invalid-input");
        $("#planned-date-cl").removeClass("invalid-input");
        $("#planned-machine-text").removeClass("invalid-input");
        var isValid = true;

        jobQuantity = $("#job-quantity-text").val();
        weight = $("#weight-text").val();
        TrollyNo = $("#trolly-number-text").val();
        plannedDate = $("#planned-date").val();
        plannedMachine = $("#planned-machine-text").val();

        console.log(plannedDate);
        
        //console.log("validate inputs data",jobQuantity,weight,TrollyNo);
        if(jobQuantity == "" || jobQuantity == 0) {
            $("#job-quantity-text").addClass("invalid-input");
            isValid = false;
        }
        if(weight == "" || weight == 0) {
            $("#weight-text").addClass("invalid-input");
            isValid = false;
        }
        if(TrollyNo == "") {
            $("#trolly-number-text").addClass("invalid-input");
            isValid = false;
        }
        if(plannedMachine == "") {
            $("#planned-machine-text").addClass("invalid-input");
            isValid = false;
        }
        if (/^[a-z]/i.test(plannedDate) || plannedDate == "") {
            $("#planned-date-cl").addClass("invalid-input");
            isValid = false;
        }
        return isValid;
    }

    function validateCreateRequestOutsource(){
        var jobQuantity = null;
        var weight = null;
        var TrollyNo = null;
        var plannedDate = null;
        var plannedMachine = null;

        $("#job-quantity-text-o").removeClass("invalid-input");
        $("#weight-text-o").removeClass("invalid-input");
        $("#trolly-number-text-o").removeClass("invalid-input");
        $("#planned-date-cl-o").removeClass("invalid-input");
        $("#planned-machine-text-o").removeClass("invalid-input");
        var isValid = true;

        jobQuantity = $("#job-quantity-text-o").val();
        weight = $("#weight-text-o").val();
        TrollyNo = $("#trolly-number-text-o").val();
        plannedDate = $("#planned-date-o").val();
        plannedMachine = $("#planned-machine-text-o").val();
        
        //console.log("validate inputs data",jobQuantity,weight,TrollyNo);
        if(jobQuantity == "" || jobQuantity == 0) {
            $("#job-quantity-text-o").addClass("invalid-input");
            isValid = false;
        }
        if(weight == "" || weight == 0) {
            $("#weight-text-o").addClass("invalid-input");
            isValid = false;
        }
        if(TrollyNo == "") {
            $("#trolly-number-text-o").addClass("invalid-input");
            isValid = false;
        }
        if(plannedMachine == "") {
            $("#planned-machine-text-o").addClass("invalid-input");
            isValid = false;
        }
        if (/^[a-z]/i.test(plannedDate) || plannedDate == "") {
            $("#planned-date-cl-o").addClass("invalid-input");
            isValid = false;
        }
        return isValid;
    }

    function loadBagBarcodeDetails() {
        DisableInputs();
        var isValid = validateCreateRequest();
        var bagbarcode = $("#bag-barcode-text").val();

        var searchduplicate = true;
        var grid = $("#bag-barcode-details-table").data("kendoGrid");
        data = grid.dataItems();
        data.forEach(d => { 
            if(d.Barcode == bagbarcode) {
                searchduplicate = false;
            }
        });

        data.forEach(d => { 
            if(d.Bag_Barcode == bagbarcode) {
                searchduplicate = false;
            }
        });

        if(deleted == "") {
            if($("#last-barcode-txt").html() == bagbarcode) {
                isValid = false;
                msgBox.show('තීරු කේතය දැනටමත් භාවිතා කර ඇත.', 'Barcode is already used.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
                return;
            }
        }

        if(searchduplicate) {
            if(isValid) {
                //if(deleted == null && $("#last-barcode-txt").html() != bagbarcode) {
                    isvalidbarcode = false;
                    deleted = "";
                    $.ajax({
                        url: '@ViewBag.APIURL/Lookup/GetStyleScheduleByBagBarcode?Barcode=' + bagbarcode,
                        type: 'GET',
                        dataType: 'json',
                        //async: false,
                        contentType: 'application/json; charset=utf-8',
                        beforeSend: function () {
                            $("#ajaxBusy").show();
                        },
                        complete: function () {
                            $("#ajaxBusy").hide();
                        },
                        success: function (response) {
                            scannedBarcode = response;
                            if (response != null) {
                                var selectedgridData = $("#bag-barcode-details-table").data("kendoGrid").dataSource.data();
                                //console.log(selectedgridData);
                                //checked whether qunatity is avilable to allocate
                                if(scannedBarcode.sizeId == 0) {
                                    if (scannedBarcode.qty01 > scannedBarcode.qty01NS) {
                                        if(selectedgridData.length > 0) {
                                                //Check whether barcode color is matched with the user input
                                                //console.log($("#color-id").html());
                                                //if($("#color-id").html() != "") {
                                                    /*if (scannedBarcode.colorId != $("#color-id").html()) {
                                                        msgBox.show('තෝරන ලද වර්ණය බෑග් බාර්කෝඩ් කේතයේ වර්ණය සමඟ නොගැලපේ. නැවත පරීක්ෂා කරන්න.', 'The selected color does not match with the bag barcode shedule code. Check again.', 'අවවාදයයි / Warning', 'BS10', 'Warning', function () {
                                                            scannedBarcode = null;
                                                            $("#bag-barcode-text").val("");
                                                            $("#bag-barcode-text").focus();
                                                            resetBagBarcodeFields();
                                                        });
                                                        return;
                                                    }*/
                                                    //$("#color-id").html(scannedBarcode.colorId); // color validation failed issue
                                                //} else {
                                                //}
                                                //Check whether barcode style is matched with the user input
                                            if($("#wf-id").html() != ""){
                                                if($("#wf-id").html() == scannedBarcode.wfId) {
                                                    if($("#color-text").html() != "") {
                                                        if (scannedBarcode.colorDesc != $("#color-text").html()) {
                                                            msgBox.show('තෝරන ලද වර්ණය බෑග් බාර්කෝඩ් කේතයේ වර්ණය සමඟ නොගැලපේ.ඉදිරියට යන්න', 'The selected color does not match with the bag barcode color code', 'අවවාදයයි / Warning', 'BS10', 'Warning');
                                                        }
                                                    }
                                                    
                                                    $("#color-text").html(scannedBarcode.colorDesc);
                                                    $("#color-id").html(scannedBarcode.colorId);

                                                    //Check whether barcode style is matched with the user input
                                                    if($("#style-id").html() != "") {
                                                        if (scannedBarcode.styleId != $("#style-id").html()) {
                                                            msgBox.show('තෝරන ලද ස්ටයිලය බෑග් බාර්කෝඩ් කේතයේ ස්ටයිලය සමඟ නොගැලපේ.ඉදිරියට යන්න', 'The selected style does not match with the bag barcode style code.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
                                                        }
                                                    }

                                                    $("#style-id").html(scannedBarcode.styleId);
                                                    $("#style-text").html(scannedBarcode.styleNo);

                                                    //Check whether barcode shedule is matched with the user input
                                                    if($("#shedule-id").html() != "") {
                                                        if (scannedBarcode.scheduleId != $("#shedule-id").html()) {
                                                            msgBox.show('තෝරන ලද ෂෙඩියුලය බෑග් බාර්කෝඩ් කේතයේ ෂෙඩියුලය සමඟ නොගැලපේ. ඉදිරියට යන්න.', 'The selected shedule does not match with the bag barcode shedule code. Check again.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
                                                        }
                                                    }
                                                    
                                                    $("#shedule-id").html(scannedBarcode.scheduleId);
                                                    $("#shedule-text").html(scannedBarcode.scheduleDesc);
                                                    $("#color-text").html(scannedBarcode.colorDesc);
                                                    $("#z-feature-text").html(scannedBarcode.zfeature);
                                                    $("#po-text").html(scannedBarcode.poNo);

                                                    $("#size-id").html(scannedBarcode.sizeId);
                                                    $("#seq-id").html(scannedBarcode.seq);
                                                    $("#dep-id").html(scannedBarcode.depid);
                                                    $("#wf-id").html(scannedBarcode.wfId);
                                                    $("#wfInst-id").html(scannedBarcode.wfdepInstId);

                                                    $("#l3-id").html(scannedBarcode.l3id);

                                                    $("#bag-quantity-text").html(scannedBarcode.qty01);
                                                    $("#unallocated-text").html(scannedBarcode.qty01-scannedBarcode.qty01NS);

                                                    $("#deliverdate-text").html(scannedBarcode.deliveryDate);
                                                    $("#allocated-text").html(scannedBarcode.qty01NS);
                                                    $("#last-barcode-txt").html(bagbarcode);
                                                    $("#color-text-i").html(scannedBarcode.colorDesc);

                                                    $("#style-label").html(scannedBarcode.styleNo);
                                                    $("#shedule-label").html(scannedBarcode.scheduleDesc);
                                                    $("#zfeature-label").html(scannedBarcode.zfeature);
                                                    $("#quantiity-label").html(scannedBarcode.qty01-scannedBarcode.qty01NS);
                                                    isvalidbarcode = true;
                                                    EnableInputs();
                                                } else {
                                                    msgBox.show('තෝරාගත් බෑගය වෙනත් ගබඩාවකින් විය. එකකට එකතු කළ නොහැක.', 'the selected bag was from another warehouse. Cannot add to one.', 'අවවාදයයි / Warning', 'BS10', 'Warning'); 
                                                }
                                            } else {
                                                $("#color-id").html(scannedBarcode.colorId);

                                                $("#style-id").html(scannedBarcode.styleId);
                                                $("#style-text").html(scannedBarcode.styleNo);
                                                $("#shedule-id").html(scannedBarcode.scheduleId);
                                                $("#shedule-text").html(scannedBarcode.scheduleDesc);
                                                $("#z-feature-text").html(scannedBarcode.zfeature);
                                                $("#po-text").html(scannedBarcode.poNo);
                                                $("#color-id").html(scannedBarcode.colorId);

                                                $("#size-id").html(scannedBarcode.sizeId);
                                                $("#seq-id").html(scannedBarcode.seq);
                                                $("#dep-id").html(scannedBarcode.depid);
                                                $("#wf-id").html(scannedBarcode.wfId);
                                                $("#wfInst-id").html(scannedBarcode.wfdepInstId);
                                                $("#l3-id").html(scannedBarcode.l3id);

                                                $("#color-text").html(scannedBarcode.colorDesc);
                                                $("#color-text-i").html(scannedBarcode.colorDesc);
                                                $("#bag-quantity-text").html(scannedBarcode.qty01);
                                                $("#unallocated-text").html(scannedBarcode.qty01-scannedBarcode.qty01NS);
                                                $("#allocated-text").html(scannedBarcode.qty01NS);

                                                $("#deliverdate-text").html(scannedBarcode.deliveryDate);
                                                $("#last-barcode-txt").html(bagbarcode);

                                                $("#style-label").html(scannedBarcode.styleNo);
                                                $("#shedule-label").html(scannedBarcode.scheduleDesc);
                                                $("#zfeature-label").html(scannedBarcode.zfeature);
                                                $("#quantiity-label").html(scannedBarcode.qty01-scannedBarcode.qty01NS);

                                                isvalidbarcode = true;
                                                EnableInputs();
                                            }
                                        } else {
                                            $("#color-id").html(scannedBarcode.colorId);
                                                
                                            $("#style-id").html(scannedBarcode.styleId);
                                            $("#style-text").html(scannedBarcode.styleNo);
                                            $("#shedule-id").html(scannedBarcode.scheduleId);
                                            $("#shedule-text").html(scannedBarcode.scheduleDesc);
                                            $("#z-feature-text").html(scannedBarcode.zfeature);
                                            $("#po-text").html(scannedBarcode.poNo);
                                            $("#color-id").html(scannedBarcode.colorId);

                                            $("#size-id").html(scannedBarcode.sizeId);
                                            $("#seq-id").html(scannedBarcode.seq);
                                            $("#dep-id").html(scannedBarcode.depid);
                                            $("#wf-id").html(scannedBarcode.wfId);
                                            $("#wfInst-id").html(scannedBarcode.wfdepInstId);
                                            $("#l3-id").html(scannedBarcode.l3id);

                                            $("#color-text").html(scannedBarcode.colorDesc);
                                            $("#color-text-i").html(scannedBarcode.colorDesc);
                                            $("#bag-quantity-text").html(scannedBarcode.qty01);
                                            $("#unallocated-text").html(scannedBarcode.qty01-scannedBarcode.qty01NS);
                                            $("#allocated-text").html(scannedBarcode.qty01NS);

                                            $("#deliverdate-text").html(scannedBarcode.deliveryDate);
                                            $("#last-barcode-txt").html(bagbarcode);

                                            $("#style-label").html(scannedBarcode.styleNo);
                                            $("#shedule-label").html(scannedBarcode.scheduleDesc);
                                            $("#zfeature-label").html(scannedBarcode.zfeature);
                                            $("#quantiity-label").html(scannedBarcode.qty01-scannedBarcode.qty01NS);

                                            isvalidbarcode = true;
                                            EnableInputs();
                                        }
                                    } else {
                                        msgBox.show('බෑග් තීරු කේතයේ වෙන් කරවා ගැනීම සඳහා ඇඟලුම් නොමැත.', 'No apparel avilable for reservation in the bag barcode.', 'අවවාදයයි / Warning', 'BS10', 'Warning', function () {
                                            scannedBarcode = null;
                                            $("#bag-barcode-text").val("");
                                            $("#bag-barcode-text").focus();
                                            EnableInputs();
                                        });
                                        return;
                                    }  
                                } else {
                                    msgBox.show('තෝරාගත් බෑග් තීරු කේතය බාහිර මූලාශ්‍ර ටැගයකි.', 'The selected bag barcode is an outsource bag tag.', 'අවවාදයයි / Warning', 'BS10', 'Warning', function () {
                                        scannedBarcode = null;
                                        $("#bag-barcode-text").val("");
                                        $("#bag-barcode-text").focus();
                                        EnableInputs();
                                    });
                                    return;
                                }

                            }
                            else {
                                resetBagBarcodeFields();
                                EnableInputs();
                                msgBox.show('බෑග් තීරු කේතය හඳුනාගත නොහැක. අවලංගු තීරු කේතයක් හෝ වෙන් කිරීමට සූදානම් නැත.', 'Cannot identfiy the bag barcode. can be a invalid barcode or not ready to allocate.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
                                $("#bag-barcode-text").focus();
                            }
                                    

                        },
                        error: function (jqXHR, textStatus, errorThrown) {
                            formatErrorMessage(jqXHR, errorThrown, "Barcode");
                            resetBagBarcodeFields();
                            EnableInputs();
                            msgBox.show('තීරු කේත දෝෂයකි.', 'Invalid barcode.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
                            $("#bag-barcode-text").focus();
                        }
                    });
                //}
            } else {
                EnableInputs();
                msgBox.show('අයිතම එකතු කිරීමට පෙර කරුණාකර යෙදවුම් පුරවන්න.', 'Please fill the inputs before add items.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
            }
        } else {
            EnableInputs();
            msgBox.show('ඔබ එක් කිරීමට උත්සාහ කරන තීරු කේතය දැනටමත් භාවිතා කර ඇත. කරුණාකර දත්ත වගු වාර්තා දෙස බලන්න.', 'The barcode that you are trying to add is already used. Please look at the data table records.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
            $("#bag-barcode-text").select();
            $("#bag-barcode-text").focus();
        }
    }

    //loadBagBarcodeDetailsOutSource
    function loadBagBarcodeDetailsOutSource() {
        DisableInputs();
        var isValid = validateCreateRequestOutsource();
        var bagbarcodeo = $("#bag-barcode-text-o").val();

        var searchduplicate = true;
        var grid = $("#bag-barcode-details-table-o").data("kendoGrid");
        data = grid.dataItems();
        data.forEach(d => { 
            if(d.Barcode == bagbarcodeo) {
                searchduplicate = false;
            }
        });

        /*
        data.forEach(d => { 
            if(d.Bag_Barcode == bagbarcodeo) {
                searchduplicate = false;
            }
        });
        */

        if(deletedo == "") {
            if($("#last-barcode-txt-o").html() == bagbarcodeo) {
                isValid = false;
                msgBox.show('තීරු කේතය දැනටමත් භාවිතා කර ඇත.', 'Barcode is already used.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
                EnableInputs();
                return;
            }
        }

        if(searchduplicate) {
            if(isValid) {
                //if(deletedo == null && $("#last-barcode-txt-o").html() != bagbarcodeo) {
                    isvalidbarcode = false;
                    deletedo == "";
                    $.ajax({
                        url: '@ViewBag.APIURL/Lookup/GetStyleScheduleByBagBarcodeOutSource?Barcode=' + bagbarcodeo,
                        type: 'GET',
                        dataType: 'json',
                        //async: false,
                        contentType: 'application/json; charset=utf-8',
                        beforeSend: function () {
                            $("#ajaxBusy").show();
                        },
                        complete: function () {
                            $("#ajaxBusy").hide();
                        },
                        success: function (response) {
                            EnableInputs();
                            scannedBarcodeo = response;
                            if (response != null) {
                                var selectedgridData = $("#bag-barcode-details-table-o").data("kendoGrid").dataSource.data();
                                //console.log(scannedBarcodeo);
                                //checked whether qunatity is avilable to allocate
                                if (scannedBarcodeo.qty01 > scannedBarcodeo.qty01NS) {
                                    if(selectedgridData.length > 0) {
                                        DisableInputs();
                                            //Check whether barcode color is matched with the user input
                                            //console.log($("#color-id").html());
                                            //if($("#color-id").html() != "") {
                                                /*if (scannedBarcodeo.colorId != $("#color-id").html()) {
                                                    msgBox.show('තෝරන ලද වර්ණය බෑග් බාර්කෝඩ් කේතයේ වර්ණය සමඟ නොගැලපේ. නැවත පරීක්ෂා කරන්න.', 'The selected color does not match with the bag barcode shedule code. Check again.', 'අවවාදයයි / Warning', 'BS10', 'Warning', function () {
                                                        scannedBarcodeo = null;
                                                        $("#bag-barcode-text").val("");
                                                        $("#bag-barcode-text").focus();
                                                        resetBagBarcodeFields();
                                                    });
                                                    return;
                                                }*/
                                                 //$("#color-id").html(scannedBarcodeo.colorId); // color validation failed issue
                                            //} else {
                                            //}
                                            //Check whether barcode style is matched with the user input
                                        if($("#wf-id-o").html() != ""){
                                            if($("#wf-id-o").html() == scannedBarcodeo.wfId) {
                                                if($("#color-text-o").html() != "") {
                                                    if (scannedBarcodeo.colorDesc != $("#color-text-o").html()) {
                                                        msgBox.show('තෝරන ලද වර්ණය බෑග් බාර්කෝඩ් කේතයේ වර්ණය සමඟ නොගැලපේ.ඉදිරියට යන්න', 'The selected color does not match with the bag barcode color code', 'අවවාදයයි / Warning', 'BS10', 'Warning');
                                                    }
                                                }
                                                
                                                $("#color-text-o").html(scannedBarcodeo.colorDesc);
                                                $("#color-id-o").html(scannedBarcodeo.colorId);

                                                //Check whether barcode style is matched with the user input
                                                if($("#style-id-o").html() != "") {
                                                    if (scannedBarcodeo.styleId != $("#style-id-o").html()) {
                                                        msgBox.show('තෝරන ලද ස්ටයිලය බෑග් බාර්කෝඩ් කේතයේ ස්ටයිලය සමඟ නොගැලපේ.ඉදිරියට යන්න', 'The selected style does not match with the bag barcode style code.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
                                                    }
                                                }

                                                $("#style-id-o").html(scannedBarcodeo.styleId);
                                                $("#style-text-o").html(scannedBarcodeo.styleNo);

                                                //Check whether barcode shedule is matched with the user input
                                                if($("#shedule-id-o").html() != "") {
                                                    if (scannedBarcodeo.scheduleId != $("#shedule-id-o").html()) {
                                                        msgBox.show('තෝරන ලද ෂෙඩියුලය බෑග් බාර්කෝඩ් කේතයේ ෂෙඩියුලය සමඟ නොගැලපේ. ඉදිරියට යන්න.', 'The selected shedule does not match with the bag barcode shedule code. Check again.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
                                                    }
                                                }
                                                
                                                $("#shedule-id-o").html(scannedBarcodeo.scheduleId);
                                                $("#shedule-text-o").html(scannedBarcodeo.scheduleDesc);
                                                $("#color-text-o").html(scannedBarcodeo.colorDesc);
                                                $("#size-text-o").html(scannedBarcodeo.sizeDesc);
                                                $("#z-feature-text-o").html(scannedBarcodeo.zfeature);
                                                $("#po-text-o").html(scannedBarcodeo.poNo);

                                                $("#size-id-o").html(scannedBarcodeo.sizeId);
                                                $("#seq-id-o").html(scannedBarcodeo.seq);
                                                $("#dep-id-o").html(scannedBarcodeo.depid);
                                                $("#wf-id-o").html(scannedBarcodeo.wfId);
                                                $("#wfInst-id-o").html(scannedBarcodeo.wfdepInstId);

                                                $("#l3-id-o").html(scannedBarcodeo.l3id);

                                                $("#bag-quantity-text-o").html(scannedBarcodeo.qty01);
                                                $("#unallocated-text-o").html(scannedBarcodeo.qty01-scannedBarcodeo.qty01NS);
                                                $("#allocated-qty-from-bag-o").val(scannedBarcodeo.qty01-scannedBarcodeo.qty01NS);
                                                $("#deliverdate-text-o").html(scannedBarcodeo.deliveryDate);
                                                $("#allocated-text-o").html(scannedBarcodeo.qty01NS);
                                                $("#last-barcode-txt-o").html(bagbarcodeo);
                                                $("#color-text-i-o").html(scannedBarcodeo.colorDesc);

                                                $("#style-label-o").html(scannedBarcodeo.styleNo);
                                                $("#shedule-label-o").html(scannedBarcodeo.scheduleDesc);
                                                $("#zfeature-label-o").html(scannedBarcodeo.zfeature);
                                                $("#size-label-o").html(scannedBarcodeo.sizeDesc);
                                                $("#quantiity-label-o").html(scannedBarcodeo.qty01-scannedBarcodeo.qty01NS);

                                                //$("#allocated-qty-from-bag-o").select();
                                                $("#allocated-qty-from-bag-o").focus();

                                                isvalidbarcode = true;
                                                EnableInputs();
                                            } else {
                                                msgBox.show('තෝරාගත් බෑගය වෙනත් ගබඩාවකින් විය. එකකට එකතු කළ නොහැක.', 'the selected bag was from another warehouse. Cannot add to one.', 'අවවාදයයි / Warning', 'BS10', 'Warning'); 
                                            }
                                        } else {
                                            $("#color-id-o").html(scannedBarcodeo.colorId);

                                            $("#style-id-o").html(scannedBarcodeo.styleId);
                                            $("#style-text-o").html(scannedBarcodeo.styleNo);
                                            $("#shedule-id-o").html(scannedBarcodeo.scheduleId);
                                            $("#shedule-text-o").html(scannedBarcodeo.scheduleDesc);
                                            $("#z-feature-text-o").html(scannedBarcodeo.zfeature);
                                            $("#po-text-o").html(scannedBarcodeo.poNo);
                                            $("#color-id-o").html(scannedBarcodeo.colorId);
                                            $("#size-text-o").html(scannedBarcodeo.sizeDesc);

                                            $("#size-id-o").html(scannedBarcodeo.sizeId);
                                            $("#seq-id-o").html(scannedBarcodeo.seq);
                                            $("#dep-id-o").html(scannedBarcodeo.depid);
                                            $("#wf-id-o").html(scannedBarcodeo.wfId);
                                            $("#wfInst-id-o").html(scannedBarcodeo.wfdepInstId);
                                            $("#l3-id-o").html(scannedBarcodeo.l3id);

                                            $("#color-text-o").html(scannedBarcodeo.colorDesc);
                                            $("#color-text-i-o").html(scannedBarcodeo.colorDesc);
                                            $("#bag-quantity-text-o").html(scannedBarcodeo.qty01);
                                            $("#unallocated-text-o").html(scannedBarcodeo.qty01-scannedBarcodeo.qty01NS);
                                            $("#allocated-text-o").html(scannedBarcodeo.qty01NS);
                                            $("#allocated-qty-from-bag-o").val(scannedBarcodeo.qty01-scannedBarcodeo.qty01NS);

                                            $("#deliverdate-text-o").html(scannedBarcodeo.deliveryDate);
                                            $("#last-barcode-txt-o").html(bagbarcodeo);

                                            $("#style-label-o").html(scannedBarcodeo.styleNo);
                                            $("#shedule-label-o").html(scannedBarcodeo.scheduleDesc);
                                            $("#zfeature-label-o").html(scannedBarcodeo.zfeature);
                                            $("#size-label-o").html(scannedBarcodeo.sizeDesc);
                                            $("#quantiity-label-o").html(scannedBarcodeo.qty01-scannedBarcodeo.qty01NS);

                                            //$("#allocated-qty-from-bag-o").select();
                                            $("#allocated-qty-from-bag-o").focus();

                                            isvalidbarcode = true;
                                            EnableInputs();
                                        }
                                    } else {
                                        $("#color-id-o").html(scannedBarcodeo.colorId);
                                            
                                        $("#style-id-o").html(scannedBarcodeo.styleId);
                                        $("#style-text-o").html(scannedBarcodeo.styleNo);
                                        $("#shedule-id-o").html(scannedBarcodeo.scheduleId);
                                        $("#shedule-text-o").html(scannedBarcodeo.scheduleDesc);
                                        $("#z-feature-text-o").html(scannedBarcodeo.zfeature);
                                        $("#po-text-o").html(scannedBarcodeo.poNo);
                                        $("#color-id-o").html(scannedBarcodeo.colorId);
                                        $("#size-text-o").html(scannedBarcodeo.sizeDesc);

                                        $("#size-id-o").html(scannedBarcodeo.sizeId);
                                        $("#seq-id-o").html(scannedBarcodeo.seq);
                                        $("#dep-id-o").html(scannedBarcodeo.depid);
                                        $("#wf-id-o").html(scannedBarcodeo.wfId);
                                        $("#wfInst-id-o").html(scannedBarcodeo.wfdepInstId);
                                        $("#l3-id-o").html(scannedBarcodeo.l3id);

                                        $("#color-text-o").html(scannedBarcodeo.colorDesc);
                                        $("#color-text-i-o").html(scannedBarcodeo.colorDesc);
                                        $("#bag-quantity-text-o").html(scannedBarcodeo.qty01);
                                        $("#unallocated-text-o").html(scannedBarcodeo.qty01-scannedBarcodeo.qty01NS);
                                        $("#allocated-text-o").html(scannedBarcodeo.qty01NS);
                                        $("#allocated-qty-from-bag-o").val(scannedBarcodeo.qty01-scannedBarcodeo.qty01NS);

                                        $("#deliverdate-text-o").html(scannedBarcodeo.deliveryDate);
                                        $("#last-barcode-txt-o").html(bagbarcodeo);

                                        $("#style-label-o").html(scannedBarcodeo.styleNo);
                                        $("#shedule-label-o").html(scannedBarcodeo.scheduleDesc);
                                        $("#zfeature-label-o").html(scannedBarcodeo.zfeature);
                                        $("#size-label-o").html(scannedBarcodeo.sizeDesc);
                                        $("#quantiity-label-o").html(scannedBarcodeo.qty01-scannedBarcodeo.qty01NS);

                                        //$("#allocated-qty-from-bag-o").select();
                                        $("#allocated-qty-from-bag-o").focus();

                                        isvalidbarcode = true;
                                        EnableInputs();
                                    }    
                                } else {
                                    msgBox.show('බෑග් තීරු කේතයේ වෙන් කරවා ගැනීම සඳහා ඇඟලුම් නොමැත.', 'No apparel avilable for reservation in the bag barcode.', 'අවවාදයයි / Warning', 'BS10', 'Warning', function () {
                                        scannedBarcodeo = null;
                                        $("#bag-barcode-text-o").val("");
                                        $("#bag-barcode-text-o").focus();
                                        EnableInputs();
                                    });
                                    return;
                                }

                            }
                            else {
                                resetBagBarcodeFields();
                                EnableInputs();
                                msgBox.show('බෑග් තීරු කේතය හඳුනාගත නොහැක. අවලංගු තීරු කේතයක් හෝ වෙන් කිරීමට සූදානම් නැත.', 'Cannot identfiy the bag barcode. can be a invalid barcode or not ready to allocate.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
                            }
                                    

                        },
                        error: function (jqXHR, textStatus, errorThrown) {
                            formatErrorMessage(jqXHR, errorThrown, "Barcode");
                            resetBagBarcodeFields();
                            EnableInputs();
                            msgBox.show('තීරු කේත දෝෂයකි.', 'Invalid barcode.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
                        }
                    });
                //}
            } else {
                EnableInputs();
                msgBox.show('අයිතම එකතු කිරීමට පෙර කරුණාකර යෙදවුම් පුරවන්න.', 'Please fill the inputs before add items.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
            }
        } else {
            EnableInputs();
            msgBox.show('ඔබ එක් කිරීමට උත්සාහ කරන තීරු කේතය දැනටමත් භාවිතා කර ඇත. කරුණාකර දත්ත වගු වාර්තා දෙස බලන්න.', 'The barcode that you are trying to add is already used. Please look at the data table records.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
        }
    }

    function allocateFromBagBarcode(){
        DisableInputs();
        var isValid = QuantityValidation();
        if (isValid) {
            if($("#bag-barcode-text").val() != "") {
                if(isvalidbarcode == true) {
                    var gridData = [];
                    if($("#bag-barcode-details-table").data("kendoGrid").dataSource.data() != undefined) {
                        gridData = $("#bag-barcode-details-table").data("kendoGrid").dataSource.data();
                    }
                    var object = {
                        Seq: $("#seq-id").html(),
                        Wfid: $("#wf-id").html(),
                        WfInstid: $("#wfInst-id").html(),
                        Depid: $("#dep-id").html(),
                        Barcode: $("#bag-barcode-text").val(),
                        Mode : 1,
                        Bag_Barcode: "",
                        Style: $("#style-text").html(),
                        L1: $("#style-id").html(),
                        Shedule: $("#shedule-text").html(),
                        PO: $("#po-text").html(),
                        Z_Feature: $("#z-feature-text").html(),
                        L2: $("#shedule-id").html(),
                        L3: $("#l3-id").html(),
                        Color: $("#color-text").html(),
                        L4: $("#color-id").html(),
                        L5: $("#size-id").html(),
                        Bag_Quantity: $("#bag-quantity-text").html(),
                        Allocate_Quantity: $("#unallocated-text").html(),
                        Remarks: "",
                    }
                    gridData.push(object);
                    //console.log(gridData);
                    $("#bag-barcode-details-table").data("kendoGrid").dataSource.data(gridData);
                    TotalQty = TotalQty + parseInt($("#unallocated-text").html());
                    console.log(TotalQty);
                    $("#current-quantitiy-text").html(TotalQty);
                    $("#remaining-quantitiy-text").html(parseInt($("#job-quantity-text").val()) - TotalQty);
                    isvalidbarcode = false;
                    resetBagBarcodeFields();
                    EnableInputs();
                    $("#bag-barcode-text").select();
                    $("#bag-barcode-text").focus();
                
                } else {
                    msgBox.show('තීරු කේත දෝෂයකි.', 'Scan a valid barcode.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
                    EnableInputs();
                    $("#bag-barcode-text").select();
                    $("#bag-barcode-text").focus();
                }
            } else {
                msgBox.show('තීරු කේත දෝෂයකි.', 'Barcode field is empty.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
                EnableInputs();
                $("#bag-barcode-text").select();
                $("#bag-barcode-text").focus();
            }
        }
    }

    function allocateFromBagBarcodeOutSource(){
        DisableInputs();
        var isValid = QuantityValidationOutSource();
        if (isValid) {
            if($("#bag-barcode-text-o").val() != "") {
                if(isvalidbarcode == true) {
                    var gridData = [];
                    if($("#bag-barcode-details-table-o").data("kendoGrid").dataSource.data() != undefined) {
                        gridData = $("#bag-barcode-details-table-o").data("kendoGrid").dataSource.data();
                    }
                    
                    var object = {
                        Seq: $("#seq-id-o").html(),
                        Wfid: $("#wf-id-o").html(),
                        WfInstid: $("#wfInst-id-o").html(),
                        Depid: $("#dep-id-o").html(),
                        Barcode: $("#bag-barcode-text-o").val(),
                        Mode : 1,
                        Bag_Barcode: "",
                        Style: $("#style-text-o").html(),
                        L1: $("#style-id-o").html(),
                        Shedule: $("#shedule-text-o").html(),
                        PO: $("#po-text-o").html(),
                        Z_Feature: $("#z-feature-text-o").html(),
                        L2: $("#shedule-id-o").html(),
                        L3: $("#l3-id-o").html(),
                        Color: $("#color-text-o").html(),
                        L4: $("#color-id-o").html(),
                        L5: $("#size-id-o").html(),
                        Size: $("#size-text-o").html(),
                        Bag_Quantity: $("#bag-quantity-text-o").html(),
                        Allocate_Quantity: $("#allocated-qty-from-bag-o").val(),
                        Remarks: "",
                    }
                    gridData.push(object);
                    //console.log(gridData);
                    $("#bag-barcode-details-table-o").data("kendoGrid").dataSource.data(gridData);
                    TotalQtyO = TotalQtyO + parseInt($("#allocated-qty-from-bag-o").val());
                    //console.log(TotalQty);
                    $("#current-quantitiy-text-o").html(TotalQtyO);
                    $("#remaining-quantitiy-text-o").html(parseInt($("#job-quantity-text-o").val()) - TotalQtyO);
                    isvalidbarcode = false;
                    resetBagBarcodeFields();
                    EnableInputs();
                    $("#bag-barcode-text-o").select();
                    $("#bag-barcode-text-o").focus();
                
                } else {
                    msgBox.show('තීරු කේත දෝෂයකි.', 'Scan a valid barcode.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
                    EnableInputs();
                    $("#bag-barcode-text-o").select();
                    $("#bag-barcode-text-o").focus();
                }
            } else {
                msgBox.show('තීරු කේත දෝෂයකි.', 'Barcode field is empty.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
                EnableInputs();
                $("#bag-barcode-text-o").select();
                $("#bag-barcode-text-o").focus();
            }
        }
    }

    function resetBagBarcodeFields() {
        $("#bag-barcode-text").val('');
        $("#shedule-text").html('');
        $("#style-text").html('');
        $("#color-text").html('');

        $("#z-feature-text").html('');
        $("#po-text").html('');
        $("#bag-quantity-text").html('');
        $("#unallocated-text").html('');
        $("#allocated-text").html('');
        $("#deliverdate-text").html('');

        $("#bag-barcode-text-o").val('');
        $("#shedule-text-o").html('');
        $("#style-text-o").html('');
        $("#color-text-o").html('');
        $("#size-text-o").html('');

        $("#z-feature-text-o").html('');
        $("#po-text-o").html('');
        $("#bag-quantity-text-o").html('');
        $("#unallocated-text-o").html('');
        $("#allocated-text-o").html('');
        $("#allocated-qty-from-bag-o").val(0);
        $("#deliverdate-text-o").html('');

        $("#last-barcode-txt").html('');
        $("#last-barcode-txt-o").html('');

        EnableInputs();
    }

    function resetControllers() {
        $("#color-text-i").html('');
        $("#job-quantity-text").val('');
        $("#weight-text").val('');
        $("#trolly-number-text").val('');
        $("#bag-barcode-text").val('');
        $("#receiver-epf-text").val('');
        $("#remarks-text").val('');
        $("#planned-machine-text").val('');

        $("#bag-barcode-details-table").data("kendoGrid").dataSource.data([]);

        TotalQty = 0;
        $("#current-quantitiy-text").html('0');
        $("#remaining-quantitiy-text").html('0');

        $("#job-quantity-text").removeClass("invalid-input");
        $("#weight-text").removeClass("invalid-input");
        $("#trolly-number-text").removeClass("invalid-input");

        $("#style-label").html('');
        $("#shedule-label").html('');
        $("#zfeature-label").html('');
        $("#quantiity-label").html('');
        $("#last-barcode-txt").html('');

        //OutSource
        $("#color-text-i-o").html('');
        $("#job-quantity-text-o").val('');
        $("#weight-text-o").val('');
        $("#trolly-number-text-o").val('');
        $("#bag-barcode-text-o").val('');
        $("#receiver-epf-text-o").val('');
        $("#remarks-text-o").val('');
        $("#planned-machine-text-o").val('');

        $("#bag-barcode-details-table-o").data("kendoGrid").dataSource.data([]);

        TotalQtyO = 0;
        $("#current-quantitiy-text-o").html('0');
        $("#remaining-quantitiy-text-o").html('0');

        $("#job-quantity-text-o").removeClass("invalid-input");
        $("#weight-text-o").removeClass("invalid-input");
        $("#trolly-number-text-o").removeClass("invalid-input");

        $("#style-label-o").html('');
        $("#shedule-label-o").html('');
        $("#size-label-o").html('');
        $("#zfeature-label-o").html('');
        $("#quantiity-label-o").html('');
        $("#allo-quantiity-filter").val(0);
        $("#last-barcode-txt-o").html('');

        resetBagBarcodeFields();
        EnableInputs();
    }

    function saveRequest() {
        $("#ajaxBusy").show();
        DisableInputs();
        var isValid = validateCreateRequest();
        if(isValid) {
            var selectedgridData = $("#bag-barcode-details-table").data("kendoGrid").dataSource.data();
            var tableData = [];
            
            $.each(selectedgridData, function (index, element) {
                var tableRowData = {
                    TravelBarCodeNo: "",
                    JobQty: $("#job-quantity-text").val(),
                    OperationCode: JSON.parse(sessionStorage.getItem("Clientconfig")).opCode1,
                    //WFDEPInstId: JSON.parse(sessionStorage.getItem("Clientconfig")).wfdepinstId,
                    Weight: $("#weight-text").val(),
                    TrollyNo: $("#trolly-number-text").val(),
                    AllocationDate: $("#allocation-date").val(),
                    PlannedMachine: $("#planned-machine-text").val(),
                    PlanedDateTime: $("#planned-date").val(),
                    EPF: $("#receiver-epf-text").val(),
                    ColorCode: $("#color-code-dropdown").val(),
                    gpRemarks: $("#remarks-text").val(),
                    Color : $("#color-text-i").html(),

                    Seq: element.Seq,
                    Wfid: element.Wfid,
                    WFDEPInstId: element.WfInstid,
                    Depid: element.Depid,
                    Barcode: element.Barcode,
                    TxnMode : element.Mode,
                    Bag_Barcode: element.Bag_Barcode,
                    L1id: element.L1,
                    L2id: element.L2,
                    L3id: element.L3,
                    L4id: element.L4,
                    L5id: element.L5,
                    Qty01: element.Allocate_Quantity,
                    Qty01NS: element.Bag_Quantity,
                    Remarks: element.Remarks,

                    ModifiedBy: sessionStorage.UserId,
                    ModifiedMachine: JSON.parse(sessionStorage.getItem("Clientconfig")).clientId,
                    CreatedBy: sessionStorage.UserId,
                    CreatedMachine: JSON.parse(sessionStorage.getItem("Clientconfig")).clientId,
                }
                tableData.push(tableRowData);
                //EnableInputs();
            });

            //console.log(tableData);
            if (tableData != null && tableData.length > 0) {
                DisableInputs();
                    var gridData = [];
                    $.ajax({
                        url: '@ViewBag.APIURL/BusinessLogics/UpdateTravelTag',
                        type: 'POST',
                        dataType: 'json',
                        async: false,
                        data: JSON.stringify(tableData),
                        contentType: 'application/json; charset=utf-8',
                        beforeSend: function () {
                        },
                        complete: function () {
                        },
                        success: function (response) {
                            //console.log(response);
                            createNewTag.close();
                            resetControllers();
                            EnableInputs();
                        },
                        error: function (jqXHR, textStatus, errorThrown) {
                            msgBox.show('තාක්ෂණ ගැටලුවකි. කරුණාකර තොරතුරු තාක්ෂණ නිලධාරියෙකු අමතන්න.', 'Error jqXHR.status = 0. Please contact a IT helpdesk officer', 'Warning', 'BU05', 'Warning', null);
                            EnableInputs();
                        }
                    });
            } else {
                msgBox.show('', 'Error occcured', 'Warning', 'BU05', 'Warning', null);
                EnableInputs();
            }
        } else {
            msgBox.show('කරුණාකර ආදාන ක්ෂේත්‍ර පරීක්ෂා කර නැවත උත්සාහ කරන්න !', 'Please check the input fields and try again !', 'Warning', 'BU05', 'Warning', null);
            EnableInputs();
        }
    }

    //Create Travel Tag Out Surce
    function saveRequestOutSource() {
        $("#ajaxBusy").show();
        DisableInputs();
        var isValid = validateCreateRequestOutsource();
        if(isValid) {
            var selectedgridData = $("#bag-barcode-details-table-o").data("kendoGrid").dataSource.data();
            var tableData = [];
            
            $.each(selectedgridData, function (index, element) {
                var tableRowData = {
                    TravelBarCodeNo: "",
                    JobQty: $("#job-quantity-text-o").val(),
                    OperationCode: JSON.parse(sessionStorage.getItem("Clientconfig")).opCode1,
                    //WFDEPInstId: JSON.parse(sessionStorage.getItem("Clientconfig")).wfdepinstId,
                    Weight: $("#weight-text-o").val(),
                    TrollyNo: $("#trolly-number-text-o").val(),
                    AllocationDate: $("#allocation-date-o").val(),
                    PlannedMachine: $("#planned-machine-text-o").val(),
                    PlanedDateTime: $("#planned-date-o").val(),
                    EPF: $("#receiver-epf-text-o").val(),
                    ColorCode: $("#color-code-dropdown-o").val(),
                    gpRemarks: $("#remarks-text-o").val(),
                    Color : $("#color-text-i-o").html(),

                    Seq: element.Seq,
                    Wfid: element.Wfid,
                    WFDEPInstId: element.WfInstid,
                    Depid: element.Depid,
                    Barcode: element.Barcode,
                    TxnMode : element.Mode,
                    Bag_Barcode: element.Bag_Barcode,
                    L1id: element.L1,
                    L2id: element.L2,
                    L3id: element.L3,
                    L4id: element.L4,
                    L5id: element.L5,
                    Qty01: element.Allocate_Quantity,
                    Qty01NS: element.Bag_Quantity,
                    Remarks: element.Remarks,

                    ModifiedBy: sessionStorage.UserId,
                    ModifiedMachine: JSON.parse(sessionStorage.getItem("Clientconfig")).clientId,
                    CreatedBy: sessionStorage.UserId,
                    CreatedMachine: JSON.parse(sessionStorage.getItem("Clientconfig")).clientId,
                }
                tableData.push(tableRowData);
                //EnableInputs();
            });

            //console.log(tableData);
            if (tableData != null && tableData.length > 0) {
                DisableInputs();
                    var gridData = [];
                    $.ajax({
                        url: '@ViewBag.APIURL/BusinessLogics/UpdateTravelTagOutSource',
                        type: 'POST',
                        dataType: 'json',
                        async: false,
                        data: JSON.stringify(tableData),
                        contentType: 'application/json; charset=utf-8',
                        beforeSend: function () {
                        },
                        complete: function () {
                        },
                        success: function (response) {
                            //console.log(response);
                            if(response != null) {
                                if(response[0] != null) {
                                    var checker = true;
                                    var databc = null;

                                    for (i = 0; i < response.length; i++) {
                                        if(checker) {
                                            checker = response[i].saveSuccessfull;
                                            databc = response[i];
                                        } 
                                    }

                                    if(!checker) {
                                        msgBox.show(databc.responce[0], '', 'Warning', 'BU05', 'Warning', null);
                                    }
                                    
                                }
                            }
                            createNewTag.close();
                            resetControllers();
                            EnableInputs();
                        },
                        error: function (jqXHR, textStatus, errorThrown) {
                            msgBox.show('තාක්ෂණ ගැටලුවකි. කරුණාකර තොරතුරු තාක්ෂණ නිලධාරියෙකු අමතන්න.', 'Error jqXHR.status = 0. Please contact a IT helpdesk officer', 'Warning', 'BU05', 'Warning', null);
                            EnableInputs();
                        }
                    });
            } else {
                msgBox.show('', 'Error occcured', 'Warning', 'BU05', 'Warning', null);
                EnableInputs();
            }
        } else {
            msgBox.show('කරුණාකර ආදාන ක්ෂේත්‍ර පරීක්ෂා කර නැවත උත්සාහ කරන්න !', 'Please check the input fields and try again !', 'Warning', 'BU05', 'Warning', null);
            EnableInputs();
        }
    }

    function cancelRequest() {
        DisableInputs();
        resetControllers();
        createNewTag.close();
        createNewTag.close();
        EnableInputs();
    }

    function resetRequest() {
        DisableInputs();
        resetControllers();
        EnableInputs();
    }

    //Add Item window Start
    function openAddItemWindow() {
        DisableInputs();
        if($("#bag-barcode-text").val() != "") {
            if(isvalidbarcode == true) {
                var qty = $("#unallocated-text").html()
                $("#open-request-item-window-button").removeAttr("disabled");
                $("#allocation-quantity-text").val('');
                $("allocation-barcode-mode-text").attr("disabled", "disabled");
                $("#bag-quantity").html(qty);
                
                $("#ModeSelect").kendoDropDownList({"dataSource":[{"Text":"Add","Value":"0"},//],
                                                                {"Text":"Remove","Value":"1"}],
                                                                "dataTextField":"Text","dataValueField":"Value"});

                

                //Item Grid Initilize
                $("#barcode-pool-table").kendoGrid({
                    dataSource: {
                        schema: {
                            model: {
                                id: "Barcode",
                                fields: {
                                    Barcode: { type: "string", editable: false },
                                    Seq: { type: "number", editable: false },
                                    Wfid: { type: "number", editable: false },
                                    WfInstid: { type: "number", editable: false },
                                    Depid: { type: "number", editable: false },
                                    L1: { type: "number", editable: false },
                                    L2: { type: "number", editable: false },
                                    L3: { type: "number", editable: false },
                                    L4: { type: "number", editable: false },
                                    L5: { type: "number", editable: false },
                                },
                            }
                        },
                        batch: true,
                    },
                    navigatable: true,
                    scrollable: true,   
                    sortable: true,
                    filterable: true,
                    columns: [
                        { field: "Barcode", title: "Bag Barcode" },
                        { field: "Seq", title: "Seq", width: "110px", hidden:true },
                        { field: "Wfid", title: "Wfid", width: "110px", hidden:true },
                        { field: "WfInstid", title: "WfInstid", width: "110px", hidden:true },
                        { field: "Depid", title: "Depid", width: "110px", hidden:true },
                        { field: "L1", title: "L1", width: "100px", hidden:true },
                        { field: "L2", title: "L2", width: "100px", hidden:true },
                        { field: "L3", title: "L3", width: "100px", hidden:true },
                        { field: "L4", title: "L4", width: "100px", hidden:true },
                        { field: "L5", title: "L5", width: "100px", hidden:true },
                        { command: [{ name: "Delete", imageClass: "k-icon k-i-close", click: function (e) {
                            e.preventDefault();
                            var dataItem = this.dataItem($(e.target).closest("tr"));
                            if (confirm('Do you really want to delete this record?')) {
                                var dataSource = $("#barcode-pool-table").data("kendoGrid").dataSource;
                                dataSource.remove(dataItem);
                                dataSource.sync();
                                $("#allocation-barcode-count").html(parseInt($("#allocation-barcode-count").html()) - 1);
                            }
                        }
                        }], title: "&nbsp;", width: "120px" },
                    ],
                });
                //End of Item Grid


                addItemsGrid = $("#split-and-allocate").kendoWindow({
                    width: "65%",
                    height: "60%",
                    title: "Add Items",
                    visible: false,
                    actions: ["Close"],
                    close: function () {
                        $("#bag-barcode-text").focus();
                        $("#bag-barcode-text").select();},
                    modal: true,
                    resizable: true,
                    draggable: true,
                    pinned: true,
                }).data("kendoWindow");

                
                $("#allocation-quantity-text").removeAttr("disabled");
                var dropdownlist = $("#ModeSelect").data("kendoDropDownList");
                dropdownlist.enable(true);
                $("#allocation-barcode-text").attr("disabled", "disabled");
                $("#allocation-barcode-count").html('0');
                $("allocation-quantity-text").val('');
                $("#barcode-pool-table").data("kendoGrid").dataSource.data([]);

                var arrows = [38, 40];
                addItemsGrid.open().center();
                 EnableInputs();
            } else {
                    msgBox.show('තීරු කේත දෝෂයකි.', 'Scan a valid barcode.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
                    EnableInputs();
                }
        } else {
            msgBox.show('තීරු කේත දෝෂයකි.', 'Barcode field is empty.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
            EnableInputs();
        }
    }

    function startScanBarcodes() {
        DisableInputs();
        $("allocation-barcode-mode-text").attr("disabled", "disabled");
        var qty = $("#bag-quantity").html();
        //console.log(qty, $("#allocation-quantity-text").val());
        if($("#allocation-quantity-text").val() == "") {
            msgBox.show('වෙන් කළ ප්‍රමාණය හිස් ය.', 'allocated quantity is empty.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
        } else if(parseInt(qty) > parseInt($("#allocation-quantity-text").val())) {
            //console.log("locked");
            $("#allocation-quantity-text").attr("disabled", "disabled");
            var dropdownlist = $("#ModeSelect").data("kendoDropDownList");
            dropdownlist.enable(false);
            $("#allocation-barcode-text").removeAttr("disabled");
            $('#open-request-item-window-button').attr("disabled", "disabled");
        } else if (qty == $("#allocation-quantity-text").val()){
            msgBox.show('සියලුම තීරු කේත වෙන් කිරීමේ විකල්පය භාවිතා කරන්න.', 'use allocate all function.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
        } else if ($("#allocation-quantity-text").val() == '0'){
            msgBox.show('තීරු කේත 0 ක් වෙන් කළ නොහැක.', 'can not allocate 0 barcodes.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
        } else {
           msgBox.show('වෙන් කළ ප්‍රමාණ දෝෂයකි. කරුණාකර පරීක්ෂා කර නැවත උත්සාහ කරන්න.', 'allocated quantity error. please check and try again.', 'අවවාදයයි / Warning', 'BS10', 'Warning'); 
        }


        EnableInputs();

        $("#allocation-barcode-text").focus();
        $("#allocation-barcode-text").select();
    }

    function proccedAllocation() {
        DisableInputs();
        $("allocation-barcode-mode-text").attr("disabled", "disabled");
        var allocated = $("#allocation-quantity-text").val();
        var qty = parseInt($("#allocation-barcode-count").html());
        //console.log($("#bag-barcode-text").val(),allocated,qty);

        var searchduplicate = true;
        var grid = $("#barcode-pool-table").data("kendoGrid");
        var scannedBarcode = $("#allocation-barcode-text").val();
        data = grid.dataItems();
        data.forEach(d => { 
            if(d.Barcode == scannedBarcode) {
                searchduplicate = false;
            }
        });

        data.forEach(d => { 
            if(d.Bag_Barcode == scannedBarcode) {
                searchduplicate = false;
            }
        });

        if(searchduplicate) {
            if(qty < allocated) {
                var gridData = $("#barcode-pool-table").data('kendoGrid').dataSource.data();
                $.ajax({
                        url: '@ViewBag.APIURL/Lookup/GetBagBarcodeByBarcode?barcode=' + $("#allocation-barcode-text").val() + '&l1id=' + $("#style-id").html() + '&l2id=' + $("#shedule-id").html() + '&l3id=' + $("#l3-id").html() + '&l4id=' + $("#color-id").html(),
                        dataType: 'json',
                        async: false,
                        contentType: 'application/json',
                        beforeSend: function () {
                            $("#ajaxBusy").show();
                        },
                        complete: function () {
                            $("#ajaxBusy").hide();
                        },
                        success: function (response) {
                            if (response != null) {
                                if(response.bagBarCodeNo == $("#bag-barcode-text").val()) {
                                    var object = {
                                        Barcode: $("#allocation-barcode-text").val(),
                                        Seq: response.seq,
                                        Wfid: response.wfid,
                                        WfInstid: response.wfdepinstId,
                                        Depid: response.depid,
                                        L1: response.l1id,
                                        L2: response.l2id,
                                        L3: response.l3id,
                                        L4: response.l4id,
                                        L5: response.l5id,
                                    }
                                    gridData.push(object);
                                    //console.log(gridData);
                                    $("#barcode-pool-table").data('kendoGrid').dataSource.data(gridData);
                                    $("#allocation-barcode-count").html(qty + 1);
                                    $("#allocation-barcode-text").val('');
                                    $("#allocation-barcode-mode-text").removeAttr("disabled");
                                    
                                    EnableInputs();

                                    $("#allocation-barcode-text").focus();
                                    $("#allocation-barcode-text").select();
                                } else {
                                    msgBox.show('තීරු කේතය තෝරාගත් බෑග් තීරු කේතයට අයත් නොවේ.', 'the barcode is not belongs to the selected bag barcode.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
                                    $("#allocation-barcode-text").val('');
                                    EnableInputs();
                                    $("#allocation-barcode-text").focus();
                                    $("#allocation-barcode-text").select();
                                }
                            } else {
                                msgBox.show('පරිලෝකනය කළ තීරු කේතය සඳහා ගැලපෙන බෑග් තීරු කේතයක් සොයාගත නොහැක හෝ මෙය දැනටමත් භාවිතා කර ඇත.', 'can not find a matched bag barcode for the scanned barcode or this is already used.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
                                $("#allocation-barcode-text").val('');
                                EnableInputs();
                                $("#allocation-barcode-text").focus();
                                    $("#allocation-barcode-text").select();
                            }
                        },
                        error: function (jqXHR, textStatus, errorThrown) {
                            formatErrorMessage(jqXHR, errorThrown, "GenerateTravelBarcode");
                            EnableInputs();
                            $("#allocation-barcode-text").focus();
                            $("#allocation-barcode-text").select();
                            EnableInputs();
                        }
                });
            } else {
                msgBox.show('වෙන් කළ තීරු කේත අර්ථ දැක්වීමට වඩා වැඩි ප්‍රමාණයක් වෙන් කළ නොහැක.', 'can not allocate more than allocated barcodes defines.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
                $("#allocation-barcode-text").val('');
                EnableInputs();
                $("#allocation-barcode-text").focus();
                $("#allocation-barcode-text").select();
            }
        } else {
            msgBox.show('ඔබ එක් කිරීමට උත්සාහ කරන තීරු කේතය දැනටමත් භාවිතා කර ඇත. කරුණාකර දත්ත වගු වාර්තා දෙස බලන්න.', 'The barcode that you are trying to add is already used. Please look at the data table records.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
            $("#allocation-barcode-text").val('');
            EnableInputs();
            $("#bag-barcode-text").select();
            $("#bag-barcode-text").focus();
        }
    }

    //on dataBound event restore previous selected rows:
    function onDataBound(e) {
        var view = this.dataSource.view();
        for (var i = 0; i < view.length; i++) {
            if (checkedIds[view[i].id]) {
                this.tbody.find("tr[data-uid='" + view[i].uid + "']")
                    .addClass("k-state-selected")
                    .find(".k-checkbox")
                    .attr("checked", "checked");
            }
        }
    }

    function splitCancel() {
        $("#allocation-barcode-text").val('');
        $("#barcode-pool-table").data('kendoGrid').dataSource.data([]);
        addItemsGrid.close();
    }

    function splitandAdd() {
        DisableInputs();
            var selectedgridData = $("#barcode-pool-table").data("kendoGrid").dataSource.data();

                if($("#bag-barcode-details-table").data("kendoGrid").dataSource.data() != undefined) {
                    gridData = $("#bag-barcode-details-table").data("kendoGrid").dataSource.data();
                }

                var headdetails ={
                    Bag_Barcode: $("#bag-barcode-text").val(),
                    Style: $("#style-text").html(),
                    Shedule: $("#shedule-text").html(),
                    PO: $("#po-text").html(),
                    Z_Feature: $("#z-feature-text").html(),
                    Color: $("#color-text").html(),
                    Bag_Quantity : $("#quantiity-label").html(),
                }

                var mode = $("#ModeSelect").data("kendoDropDownList").value();
                //console.log("selected split mode:", mode);

                if(mode == 0) {
                    $.each(selectedgridData, function (index, element) {
                        var object = {
                            Seq: element.Seq,
                            Wfid: element.Wfid,
                            WfInstid: element.WfInstid,
                            Depid: element.Depid,
                            Barcode: element.Barcode,
                            Mode : 0,
                            Bag_Barcode: headdetails.Bag_Barcode,
                            Style: headdetails.Style,
                            L1: element.L1,
                            Shedule: headdetails.Shedule,
                            PO: headdetails.PO,
                            Z_Feature: headdetails.Z_Feature,
                            L2: element.L2,
                            L3: element.L3,
                            Color: headdetails.Color,
                            L4: element.L4,
                            L5: element.L5,
                            Bag_Quantity: headdetails.Bag_Quantity,
                            Allocate_Quantity: 1,
                            Remarks: "",
                        }
                        
                        TotalQty = TotalQty + 1;
                        $("#current-quantitiy-text").html(TotalQty);
                        $("#remaining-quantitiy-text").html(parseInt($("#job-quantity-text").val()) - TotalQty);
                        gridData.push(object);
                    });
                    console.log(TotalQty);
                    $("#bag-barcode-text").focus();
                    $("#bag-barcode-text").select();
                    
            } else {
                //console.log("subtract selected");
                var RemovedGridData = [];
                $.each(selectedgridData, function (index, element) {
                        var object = {
                            Seq: element.Seq,
                            WFId: element.Wfid,
                            DEPId: element.Depid,
                            Barcode: element.Barcode,
                            BagBarcode: $("#bag-barcode-text").val(),
                            L1idBag: element.L1,
                            L2idBag: element.L2,
                            L3idBag: element.L3,
                            L4idBag: element.L4,
                            L5idBag: element.L5,
                        }
                        RemovedGridData.push(object);
                    });

                $.ajax({
                        url: '@ViewBag.APIURL/BusinessLogics/GetAddedBarcodesByRemoved',
                        type: 'POST',
                        dataType: 'json',
                        async: false,
                        data: JSON.stringify(RemovedGridData),
                        contentType: 'application/json; charset=utf-8',
                        beforeSend: function () {
                            $("#ajaxBusy").show();
                        },
                        complete: function () {
                            $("#ajaxBusy").hide();
                        },
                        success: function (response) {
                            //console.log("added barcodes :",response);

                            $.each(response, function (index, element) {
                                var object = {
                                    Seq: element.seq,
                                    Wfid: element.wfId,
                                    WfInstid: element.wfdepInstId,
                                    Depid: element.depId,
                                    Barcode: element.barcode,
                                    Mode : 0,
                                    Bag_Barcode: element.bagBarcode,
                                    Style: headdetails.Style,
                                    L1: element.l1idBag,
                                    Shedule: headdetails.Shedule,
                                    PO: headdetails.PO,
                                    Z_Feature: headdetails.Z_Feature,
                                    L2: element.l2idBag,
                                    L3: element.l3idBag,
                                    Color: headdetails.Color,
                                    L4: element.l4idBag,
                                    L5: element.l5idBag,
                                    Bag_Quantity: 1,
                                    Allocate_Quantity: 1,
                                    Remarks: "",
                                }
                                
                                TotalQty = TotalQty + 1;
                                $("#current-quantitiy-text").html(TotalQty);
                                $("#remaining-quantitiy-text").html(parseInt($("#job-quantity-text").val()) - TotalQty);
                                gridData.push(object);
                            });
                            console.log(TotalQty);
                            $("#allocation-barcode-text").focus();
                            $("#allocation-barcode-text").select();
                        },
                        error: function (jqXHR, textStatus, errorThrown) {
                            formatErrorMessage(jqXHR, errorThrown, "GenerateTravelBarcode");
                            EnableInputs();
                        }
                    });
            }

            //console.log(gridData);
                
            var isValid = QuantityValidation();
            if (isValid) {
                $("#bag-barcode-details-table").data("kendoGrid").dataSource.data(gridData);
                isvalidbarcode = false;
                resetBagBarcodeFields();
                addItemsGrid.close();
                EnableInputs();

                $("#bag-barcode-text").focus();
                $("#bag-barcode-text").select();
            }
        
    }

    function QuantityValidation() {
        var isValid = true;
        //console.log("Total Quantity was job quantitiy check",TotalQty,parseInt($('#job-quantity-text').val()));
        if(TotalQty >= parseInt($('#job-quantity-text').val())) {
            isValid = false;
            EnableInputs();
            msgBox.show('ඔබ උත්සාහ කරන්නේ වෙන් කළ ප්‍රමාණයට වඩා වැඩි ප්‍රමාණයක් වෙන් කිරීමට ය. කරුණාකර ප්‍රමාණය පරීක්ෂා කරන්න.', 'you are trying to allocate more than allocated quantity. Please check the for the quantity.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
        }
        return isValid;
    }

    function QuantityValidationOutSource() {
        var isValid = true;
        //console.log("Total Quantity was job quantitiy check",TotalQty,parseInt($('#job-quantity-text').val()));
        if(TotalQtyO >= parseInt($('#job-quantity-text-o').val())) {
            isValid = false;
            EnableInputs();
            msgBox.show('ඔබ උත්සාහ කරන්නේ වෙන් කළ ප්‍රමාණයට වඩා වැඩි ප්‍රමාණයක් වෙන් කිරීමට ය. කරුණාකර ප්‍රමාණය පරීක්ෂා කරන්න.', 'you are trying to allocate more than allocated quantity. Please check the for the quantity.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
            $("#allocated-qty-from-bag-o").focus();
        }
        if($("#allocated-qty-from-bag-o").val() == "") {
            isValid = false;
            EnableInputs();
            msgBox.show('ඉදිරියට යාමට පෙර වෙන් කිරීමට ප්‍රමාණයක් ඇතුළත් කරන්න.', 'please enter a quantity to allocate before proceed.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
            $("#allocated-qty-from-bag-o").focus();
        }
        if(parseInt($("#unallocated-text-o").html()) < parseInt($("#allocated-qty-from-bag-o").val())) {
            isValid = false;
            EnableInputs();
            msgBox.show('ඔබ උත්සාහ කරන්නේ ඉතිරි ප්‍රමාණයට වඩා වැඩි ප්‍රමාණයක් වෙන් කිරීමට ය. කරුණාකර ප්‍රමාණය පරීක්ෂා කරන්න.', 'you are trying to allocate more than remaining quantity. Please check the for the quantity.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
            $("#allocated-qty-from-bag-o").focus();
        }
        if(parseInt($("#allocated-qty-from-bag-o").val()) == 0) {
            isValid = false;
            EnableInputs();
            msgBox.show('බෑගයකින් ප්‍රමාණය 0 ක් වෙන් කළ නොහැක.', 'cannot allocate 0 quantity from a bag. Please check the for the quantity.', 'අවවාදයයි / Warning', 'BS10', 'Warning');
            $("#allocated-qty-from-bag-o").focus();
        }
        return isValid;
    }

    //Open Expand Table Window
    function openExandTable() {
        
        var additemtabledatat = $("#bag-barcode-details-table").data('kendoGrid').dataSource.data();

        if(additemtabledatat != null) {
            var gridData = [];
            $.each(additemtabledatat, function (index, elements) {
                        var object = {
                            Key: elements.Style + " | " + elements.Shedule + " | " + elements.Color,
                            Seq: elements.Seq,
                            Wfid: elements.Wfid,
                            Depid: elements.Depid,
                            Barcode: elements.Barcode,
                            Mode: elements.Mode,
                            Bag_Barcode: elements.Bag_Barcode,
                            Style: elements.Style,
                            L1: elements.L1,
                            Shedule: elements.Shedule,
                            PO: elements.PO,
                            Z_Feature: elements.Z_Feature,
                            L2: elements.L2,
                            L3: elements.L3,
                            Color: elements.Color,
                            L4: elements.L4,
                            L5: elements.L5,
                            Bag_Quantity: elements.Bag_Quantity,
                            Allocate_Quantity: elements.Allocate_Quantity,
                            Remarks: elements.Remarks
                        }
                        gridData.push(object);
                        //EnableInputs();
                    });
                console.log(gridData);
                $("#expand-items-grid").data('kendoGrid').dataSource.data(gridData);
        }


        expandedTableWindow = $("#expandedWindow").kendoWindow({
            width: "90%",
            height: "80%",
            title: "Expand",
            visible: false,
            actions: ["Close"],
            modal: true,
            resizable: true,
            draggable: true,
            pinned: true,
        }).data("kendoWindow");

        var arrows = [38, 40];
        expandedTableWindow.open().center();
        EnableInputs();
    }

    //Open Expand Table Window Out Source
    function openExandTableOutSource() {
        
        var additemtabledatat = $("#bag-barcode-details-table-o").data('kendoGrid').dataSource.data();

        if(additemtabledatat != null) {
            var gridData = [];
            $.each(additemtabledatat, function (index, elements) {
                        var object = {
                            Key: elements.Style + " | " + elements.Shedule + " | " + elements.Color,
                            Seq: elements.Seq,
                            Wfid: elements.Wfid,
                            Depid: elements.Depid,
                            Barcode: elements.Barcode,
                            Mode: elements.Mode,
                            Bag_Barcode: elements.Bag_Barcode,
                            Style: elements.Style,
                            L1: elements.L1,
                            Shedule: elements.Shedule,
                            PO: elements.PO,
                            Z_Feature: elements.Z_Feature,
                            L2: elements.L2,
                            L3: elements.L3,
                            Color: elements.Color,
                            L4: elements.L4,
                            L5: elements.L5,
                            Size: elements.Size,
                            Bag_Quantity: elements.Bag_Quantity,
                            Allocate_Quantity: elements.Allocate_Quantity,
                            Remarks: elements.Remarks
                        }
                        gridData.push(object);
                        //EnableInputs();
                    });
                console.log(gridData);
                $("#expand-items-grid-o").data('kendoGrid').dataSource.data(gridData);
        }


        expandedTableWindow = $("#expandedWindow-o").kendoWindow({
            width: "90%",
            height: "80%",
            title: "Expand",
            visible: false,
            actions: ["Close"],
            modal: true,
            resizable: true,
            draggable: true,
            pinned: true,
        }).data("kendoWindow");

        var arrows = [38, 40];
        expandedTableWindow.open().center();
        EnableInputs();
    }
    //End of Add Item

    //Print Travel tag: START
    function PrintTravelTag() {
        $("#paper").kendoDropDownList({
            change: function () {
            $(".pdf-page")
                .removeClass("size-a4")
                .removeClass("size-letter")
                .removeClass("size-executive")
                .addClass(this.value());
            }
        });
    }

    function openPrintWindow() {
        //console.log(rowDataItem);
        DisableInputs();
        //Print Page Contrrolers
        if(rowDataItem != null) {
            printpdfwindow = null;
            
            $("#paper").kendoDropDownList({
                change: function () {
                $(".pdf-page")
                    .removeClass("size-a4")
                    .removeClass("size-letter")
                    .removeClass("size-executive")
                    .addClass(this.value());
                }
            });

            if($("#item-grid-print").html() == '') {
                $("#item-grid-print").kendoGrid({
                    dataSource: {
                        schema: {
                            model: {
                                id: "BagBarcode",
                                fields: {
                                    Key: { type: "string", editable: false },
                                    Seq: { type: "number", editable: false },
                                    TxnMode: { type: "number", editable: false },
                                    Style: { type: "string", editable: false },
                                    Shedule: { type: "string", editable: false },
                                    PO: { type: "string", editable: false },
                                    ZFeature: { type: "string", editable: false },
                                    DeliveryDate: { type: "date", editable: false },
                                    Color: { type: "string", editable: false },
                                    Size: { type: "string", editable: false },
                                    Quantity: { type: "number", editable: false }
                                },
                            }
                        },
                        batch: true,
                        group: {
                            field: "Key", aggregates: [
                                { field: "Style", aggregate: "count" },
                                { field: "Quantity", aggregate: "sum"},
                                { field: "Key", aggregate: "count" }
                            ]
                        },
                        aggregate: [ { field: "Style", aggregate: "count" },
                                        { field: "Quantity", aggregate: "sum" },
                                        { field: "Key", aggregate: "min" },
                                        { field: "Key", aggregate: "max" }]
                    },
                    scrollable: false,      
                    sortable: false,
                    filterable: false,
                    columns:[
                                {title:"Key",field:"Key",width:"22px",hidden:true, aggregates: ["count"], groupHeaderTemplate: "#= value # (Count: #= count#)"},
                                {title:"Seq",field:"Seq",width:"34px",hidden:true},
                                {title:"TxnMode",field:"TxnMode",width:"55px",hidden:true},
                                {title:"Style",field:"Style",width:"55px", aggregates: ["count"]},
                                {title:"Shedule",field:"Shedule",width:"58px"},
                                {title:"PO",field:"PO",width:"60px"},
                                {title:"Z-Feature",field:"ZFeature",width:"60px"},
                                {title:"Delivery Date",field:"DeliveryDate",width:"60px",hidden:true},
                                {title:"Color",field:"Color",width:"115px"},
                                {title:"Size",field:"Size",width:"35px", footerTemplate: "Total", groupFooterTemplate: "Sub Total"},
                                {title:"Quantity",field:"Quantity",width:"46px",encoded:true, aggregates: ["sum"], groupFooterTemplate: "#=sum#", footerTemplate: "#=sum#"},
                                {title:"Remark",width:"66px",encoded:true},
                            ],
                });
            }

            if($("#bag-grid-print").html() == '') {
                $("#bag-grid-print").kendoGrid({
                    dataSource: {
                        schema: {
                            model: {
                                id: "BagBarcode",
                                fields: {
                                    Key: { type: "string", editable: false },
                                    Seq: { type: "number", editable: false },
                                    TxnMode: { type: "number", editable: false },
                                    Style: { type: "string", editable: false },
                                    Shedule: { type: "string", editable: false },
                                    PO: { type: "string", editable: false },
                                    ZFeature: { type: "string", editable: false },
                                    Bag_Barcode: { type: "string", editable: false },
                                    Color: { type: "string", editable: false },
                                    Quantity: { type: "number", editable: false },
                                    Qty01Ns: { type: "number", editable: false },
                                    Remark: { type: "string", editable: false },
                                },
                            }
                        },
                        batch: true,
                        group: {
                            field: "Key", aggregates: [
                                { field: "Style", aggregate: "count" },
                                { field: "Quantity", aggregate: "sum"},
                                { field: "Qty01Ns", aggregate: "sum" },
                                { field: "Key", aggregate: "count" }
                            ]
                        },
                        aggregate: [ { field: "Style", aggregate: "count" },
                                        { field: "Quantity", aggregate: "sum" },
                                        { field: "Qty01Ns", aggregate: "sum" },
                                        { field: "Key", aggregate: "min" },
                                        { field: "Key", aggregate: "max" }]
                    },
                    scrollable: false,      
                    sortable: false,
                    filterable: false,
                    columns:[
                                {title:"Key",field:"Key",width:"22px",hidden:true, aggregates: ["count"], groupHeaderTemplate: "#= value # (Count: #= count#)"},
                                {title:"Seq",field:"Seq",width:"34px"},
                                {title:"TxnMode",field:"TxnMode",width:"58px",hidden:true},
                                {title:"Style",field:"Style",width:"58px", aggregates: ["count"]},
                                {title:"Shedule",field:"Shedule",width:"58px"},
                                {title:"PO",field:"PO",width:"70px"},
                                {title:"Color",field:"Color",width:"100px"},
                                {title:"Used Group Barcode",field:"Bag_Barcode",width:"66px", footerTemplate: "Total", groupFooterTemplate: "Sub Total"},
                                {title:"Quantity",field:"Quantity",width:"66px", aggregates: ["sum"], groupFooterTemplate: "#=sum#", footerTemplate: "#=sum#"},
                                {title:"Used Quantitiy As at",field:"Qty01Ns",width:"66px",width:"66px", aggregates: ["sum"], groupFooterTemplate: "#=sum#", footerTemplate: "#=sum#"},
                                {title:"Remark", field:"Remark", width:"66px",encoded:true},
                            ],
                });
            }
            
            //{title:"Z-Feature",field:"ZFeature",width:"60px"},
            GetPrintTravelTag(rowDataItem.TravelBarCodeNo);

            printpdfwindow = $("#printpdf").kendoWindow({
                        height: "75%",
                        title: "Print Dispatch Note",
                        visible: false,
                        actions: ["Close"],
                        scrollable: true,
                        modal: true,
                        resizable: true,
                        draggable: true,
                        pinned: true,
                    }).data("kendoWindow");

                var arrows = [38, 40];
                printpdfwindow.open().center(); 
        }
        EnableInputs();
    }
    
    function GetPrintTravelTag(travelcode) {
        var timenow = event.timeStamp;
        var gridData = [];
        if(travelcode != "") {
            $.ajax({
                url: '@ViewBag.APIURL/Lookup/GetTravelTagHeaderDetailsForPrint?traveltagId=' + travelcode,
                type: 'GET',
                async: false,
                contentType: 'application/json; charset=utf-8',
                success: function (result) {
                    //console.log(result);
                    if(result != null && result != "") {
                        if(result.txnMode == 2){
                            $("#bagbarcodetable").show();
                            $("#preocessdetail").show();
                        } else {
                            $("#bagbarcodetable").hide();
                            $("#preocessdetail").hide();
                        }
                        $("#job-quantitiy").html(result.jobQty);
                        $("#epf").html(result.epf);
                        $("#weight").html(result.weight);
                        $("#trolly-no").html(result.trollyNo);
                        $("#remarks").html(result.remarks);

                        //Print Page
                        $("#travel-barcode").html("*" + travelcode + "*");
                        $("#tag-header").html((result.txnMode == 2 ? "TRAVEL TAG" : "BUDDY TAG"));
                        $("#items-header").html((result.txnMode == 2 ? "TRAVEL TAG ITEMS" : "BUDDY TAG ITEMS"));
                        
                        $("#time-stamp").html((new Date()).toLocaleDateString("en-US", { month: '2-digit', day: '2-digit', year: 'numeric'}));
                        //header
                        $("#job-quantity-p").html(result.jobQty + " Nos");
                        $("#epf-p").html(result.epf);
                        $("#weight-p").html(result.weight + " Kg");
                        $("#printed-time-p").html((new Date()).toLocaleTimeString("en-US"));
                        $("#printed-date-p").html((new Date()).toLocaleDateString("en-US", { month: '2-digit', day: '2-digit', year: 'numeric'}));
                        $("#trolly-no-p").html(result.trollyNo);
                        $("#remarks-p").html(result.remarks);
                        $("#planned-time-p").html(result.planedDateTime.replace("T"," "));
                        $("#planned-machine-p").html(result.plannedMachine);

                        $("#factory-p").html(result.facCode);
                        $("#factory-h").html(result.facCode);

                        //Request Item Grid Data
                        $("#item-grid-print") != undefined ? $("#item-grid-print").data('kendoGrid').dataSource.data([]) : "";
                        $("#bag-grid-print") != undefined ? $("#bag-grid-print").data('kendoGrid').dataSource.data([]) : "";
                        var gridData1 = [];
                        var gridData2 = [];

                        $.ajax({
                                url: '@ViewBag.APIURL/Lookup/GetTravelBarcodeDetails?travelcode=' + travelcode,
                                type: 'GET',
                                dataType: 'json',
                                async: false,
                                contentType: 'application/json',
                                beforeSend: function () {
                                    $("#ajaxBusy").show();
                                },
                                complete: function () {
                                    $("#ajaxBusy").hide();
                                },  
                                success: function (response) {
                                    //console.log(response);
                                    var usList = [];
                                    var Total = 0;
                                    $.each(response, function (index, elements) {
                                        var object = {
                                            Key: elements.styleDesc + " | " + elements.scheduleDesc + " | " + elements.colorDesc,
                                            Seq: elements.seq,
                                            TxnMode: elements.txnMode,
                                            Style: elements.styleDesc,
                                            Shedule: elements.scheduleDesc,
                                            PO: elements.poNo,
                                            ZFeature: elements.zfeature,
                                            DeliveryDate: formatDate(elements.deliveryDate),
                                            Color: elements.colorDesc,
                                            Size: elements.sizeDesc,
                                            Quantity: elements.qty01,
                                        }

                                        Total = parseInt(elements.qty01) + Total;

                                        usList[0] == undefined ? usList[0] = elements.scheduleDesc : (!usList[0].includes(elements.scheduleDesc) ? (usList[0] = (usList[0] + " | " + elements.scheduleDesc)) : usList[0] = usList[0]);

                                        //PO
                                        usList[1] == undefined ? usList[1] = elements.poNo : (!usList[1].includes(elements.poNo) ? (usList[1] = (usList[1] + " | " + elements.poNo)) : usList[1] = usList[1]);
                                        //Z Feature
                                        usList[2] == undefined ? usList[2] = elements.zfeature : (!usList[2].includes(elements.zfeature) ? (usList[2] = (usList[2] + " | " + elements.zfeature)) : usList[2] = usList[2]);
                                        //Color
                                        usList[3] == undefined ? usList[3] = elements.colorDesc : (!usList[3].includes(elements.colorDesc) ? (usList[3] = (usList[3] + " | " + elements.colorDesc)) : usList[3] = usList[3]);
                                        //Style
                                        usList[4] == undefined ? usList[4] = elements.styleDesc : (!usList[4].includes(elements.styleDesc) ? (usList[4] = (usList[4] + " | " + elements.styleDesc)) : usList[4] = usList[4]);
                                        //Delivery Date
                                        usList[5] == undefined ? usList[5] = formatDate(elements.deliveryDate) : (!usList[5].includes(formatDate(elements.deliveryDate)) ? (usList[5] = (usList[5] + " | " + formatDate(elements.deliveryDate))) : usList[5] = usList[5]);
                                        //Week
                                        usList[6] == undefined ? usList[6] = getNumberOfWeek(elements.deliveryDate).toString() : (!usList[6].includes(getNumberOfWeek(elements.deliveryDate).toString()) ? (usList[6] = (usList[6] + " | " + getNumberOfWeek(elements.deliveryDate).toString())) : usList[6] = usList[6]);

                                        gridData1.push(object);
                                    });
                                    //console.log("Travel Barcode Details Data Outputs: ", gridData1, usList);
                                    $("#item-grid-print").data('kendoGrid').dataSource.data(gridData1);

                                    //Travel Tag Other Data for Header
                                    //Header Elements 
                                    $("#quantity-p").html(Total + " Nos");
                                    $("#purchase-order").html(usList[1]);
                                    $("#shedule-no").html(usList[0]);
                                    $("#customer-name").html();
                                    $("#delivery-date").html(usList[5]);

                                    //header
                                    $("#purchase-order-p").html(usList[1]);
                                    $("#shedule-no-p").html(usList[0]);
                                    $("#customer-name").html('');
                                    $("#delivery-date-p").html(usList[5]);
                                    $("#customer-name-p").html('');
                                    $("#week-no-p").html(usList[6]);

                                    $("#style-p").html(usList[4]);
                                    $("#color-p").html(usList[3]);
                                },
                                error: function (jqXHR, textStatus, errorThrown) {
                                    formatErrorMessage(jqXHR, errorThrown, "GenerateTravelBarcode");
                                    EnableInputs();
                                }
                        });

                        if(result.txnMode == 2) {
                            $.ajax({    
                                    url: '@ViewBag.APIURL/Lookup/GetBagBarcodeDetailsbyTravelBarcode?travelcode=' + travelcode,
                                    type: 'GET',
                                    dataType: 'json',
                                    async: false,
                                    contentType: 'application/json',
                                    beforeSend: function () {
                                        $("#ajaxBusy").show();
                                    },
                                    complete: function () {
                                        $("#ajaxBusy").hide();
                                    },  
                                    success: function (response) {
                                        //console.log(response);
                                        $.each(response, function (index, elements) {
                                            var object = {
                                                Key: elements.styleDesc + " | " + elements.scheduleDesc + " | " + elements.colorDesc,
                                                Seq: elements.seq,
                                                TxnMode: elements.txnMode,
                                                Style: elements.styleDesc,
                                                Shedule: elements.scheduleDesc,
                                                PO: elements.poNo,
                                                ZFeature: elements.zfeature,
                                                Bag_Barcode: elements.bagBarCode,
                                                Color: elements.colorDesc,
                                                Quantity: (parseInt(elements.qty01) - parseInt(elements.qty02) - parseInt(elements.qty03)),
                                                Qty01Ns: (parseInt(elements.qty01Ns) - parseInt(elements.qty02Ns) - parseInt(elements.qty03Ns)),
                                                Remark: elements.remark,
                                            }

                                            gridData2.push(object);
                                        });
                                        //console.log("Travel Barcode Details Data Outputs: ", gridData1, usList);
                                        $("#bag-grid-print").data('kendoGrid').dataSource.data(gridData2);
                                    },
                                    error: function (jqXHR, textStatus, errorThrown) {
                                        formatErrorMessage(jqXHR, errorThrown, "GenerateTravelBarcode");
                                        EnableInputs();
                                    }
                            });
                        }
                        EnableInputs();
                    }
                },
                error: function () {
                    $("#search-result-grid-gatepass").html('No Results found !!!');
                    EnableInputs();
                    FocusRequestNoTextBox();
                }
            });

            //Request Status Grid
                                                                   
        } else {
            msgBox.show('කරුණාකර යැවීමේ සටහන් අංකයක් තෝරා නැවත උත්සාහ කරන්න.', 'please select a request id and try again.'
            , 'අවවාදයයි / Warning', 'BS01', 'Warning');
            EnableInputs();
        }
    }

    //Function to get week number
    function getNumberOfWeek(indate) {
        const date = new Date(Date.parse(indate));
        const firstDayOfYear = new Date(date.getFullYear(), 0, 1);
        const pastDaysOfYear = (date - firstDayOfYear) / 86400000;
        return Math.ceil((pastDaysOfYear + firstDayOfYear.getDay() + 1) / 7);
    }

    //Print Comtrollers
    function Print() {
        DisableInputs();
        if($("#dispatch-number").html() != "") {
            printpdfwindow = $("#printpdf").kendoWindow({
                    height: "75%",
                    title: "Print Travel Tag",
                    visible: false,
                    actions: ["Close"],
                    scrollable: true,
                    modal: true,
                    resizable: true,
                    draggable: true,
                    pinned: true,
                }).data("kendoWindow");

            var arrows = [38, 40];
            printpdfwindow.open().center();
            EnableInputs();  
        } else {
            EnableInputs();
            msgBox.show('කරුණාකර යැවීමේ සටහනක් පටවා නැවත උත්සාහ කරන්න.', 'please load an dispatch note and try again.', 'අවවාදයයි / Warning', 'BS01', 'Warning');
        }
    }
    
    function getPDF(selector) {
      kendo.drawing.drawDOM($(selector), {
           //forcePageBreak: ".items-page-break",
           paperSize: "A4",
           allPages: true,
           avoidLinks: true,
           paperSize: "A4",
           margin: { top: "0cm", left: "0cm", right: "1cm", bottom: "0cm" },
           repeatHeaders: true,
           scale: 0.9
      }).then(function (group) {
            kendo.drawing.pdf.saveAs(group, "Travel Tag" + $("#travel-barcode").html() + ".pdf");
        });
    }

    //Print Travel tag: END

    //Checkers
    function isNumeric(n) {
          return !isNaN(parseFloat(n)) && isFinite(n);
    }

    function getBoolean(str) {
        if("true".startsWith(str)){
            return true;
        } else if("false".startsWith(str)){
            return false;
        } else {
            return null;
        }          
    }
    //End of Checkers

    //Input Controllers: START
    function DisableInputs() {
        $("#gate-pass-request-create-button").attr('disabled', 'disabled');
        $("#gate-pass-reset-cancel-button").attr('disabled', 'disabled');
        $("#gate-pass-request-cancel-button").attr('disabled', 'disabled');

        $("#gate-pass-request-create-button-o").attr('disabled', 'disabled');
        $("#gate-pass-reset-cancel-button-o").attr('disabled', 'disabled');
        $("#gate-pass-request-cancel-button-o").attr('disabled', 'disabled');

        $("#open-request-item-window-button").attr('disabled', 'disabled');
        $("#open-split-item-window-button").attr('disabled', 'disabled');
        $("#open-request-item-window-button-o").attr('disabled', 'disabled');
        $("#open-split-item-window-button-o").attr('disabled', 'disabled');

        $("#split-add-button").attr('disabled', 'disabled');
        $("#split-cancel-button").attr('disabled', 'disabled');
        $("#ajaxBusy").show();
    }

    function EnableInputs() {
        $("#gate-pass-request-create-button").removeAttr('disabled');
        $("#gate-pass-reset-cancel-button").removeAttr('disabled');
        $("#gate-pass-request-cancel-button").removeAttr('disabled');

        $("#gate-pass-request-create-button-o").removeAttr('disabled');
        $("#gate-pass-reset-cancel-button-o").removeAttr('disabled');
        $("#gate-pass-request-cancel-button-o").removeAttr('disabled');

        $("#open-request-item-window-button").removeAttr('disabled');
        $("#open-split-item-window-button").removeAttr('disabled');
        $("#open-request-item-window-button-o").removeAttr('disabled');
        $("#open-split-item-window-button-o").removeAttr('disabled');

        $("#split-add-button").removeAttr('disabled');
        $("#split-cancel-button").removeAttr('disabled');
        $("#ajaxBusy").hide();
    }

    function formatDate(date) {
        return (new Date(Date.parse(date)).toLocaleDateString("en-US", { month: '2-digit', day: '2-digit', year: 'numeric'}));
        //return (date == null || date == undefined || date == "") ? date : date.replace(/T/g, " ")
    }
    //Input Controllers: END

    //Open tag audit
    function openTagAudit(){
        window.location.href = "GroupBarcodeAudit";
    }
</script>


<div>
    <div style="margin-top: 5px; margin-left: 5px;">
        <!--CREATE TRAVEL TAG BUTTON: BEGIN -->
        <div id="createNewTTag">
            <div style="float: left; margin-right: -74px; margin-bottom: 10px;">
                <button id="new-request-button" class="k-button" style="background-color: #FFA000; border: none; font-size: 17px; font-weight: 600; color: #000000;" onclick="opencreateNewTag()">
                    <span class="k-icon k-i-plus" style="margin-right: 7px;"></span><span>Create New Travel Tag</span>
                </button>
            </div>
            <div style="float: left;">
                <span id="gate-pass-creation-status" style="color: #51a351; font-size: large; visibility: hidden">
                    Sucessful
                </span>
            </div>
        </div>
        <!--MANAGE TRAVEL TAG BUTTON: BEGIN -->
        <div id="NewTTagOutsource">
            <div style="float: left; margin-bottom: 10px;">
                <button id="outsorce-tag-button" class="k-button" style="background-color: #FFA000; border: none; font-size: 17px; font-weight: 600; color: #000000;" onclick="opencreateNewTagOutSource()">
                    <span class="k-icon k-i-plus" style="margin-right: 7px;"></span><span>Create New Travel Tag (Outsource)</span>
                </button>
            </div>
            <div style="float: left; width: 13px;">
                <span id="gate-pass-creation-status-1" style="color: #51a351; font-size: large; visibility: hidden">
                    Sucessful
                </span>
            </div>
        </div>
        <!--MANAGE TRAVEL TAG BUTTON: BEGIN -->
        <div id="manageNewTTag">
            <div style="float: left; margin-right: 30px; margin-bottom: 10px;">
                <button id="manage-tag-button" class="k-button" style="background-color: #E65100; border: none; font-size: 17px; font-weight: 600; color: #000000;" onclick="openmanageTag()">
                    <span class="k-icon k-i-plus" style="margin-right: 7px;"></span><span>Manage Travel Tag</span>
                </button>
            </div>
            <div style="float: left;">
                <span id="gate-pass-creation-status-2" style="color: #51a351; font-size: large; visibility: hidden">
                    Sucessful
                </span>
            </div>
        </div>
        <!--MANAGE TRAVEL TAG BUTTON: BEGIN -->
        <div id="manageNewTTag">
            <div style="float: left; margin-right: 30px; margin-bottom: 10px;">
                <button id="audit-tag-button" class="k-button" style="background-color: #13ff1d; border: none; font-size: 17px; font-weight: 600; color: #000000;" onclick="openTagAudit()">
                    <span class="k-icon k-i-plus" style="margin-right: 7px;"></span><span>Tag Audit</span>
                </button>
            </div>
            <div style="float: left;">
                <span id="gate-pass-creation-status-2" style="color: #51a351; font-size: large; visibility: hidden">
                    Sucessful
                </span>
            </div>
        </div>
    <div style="clear:both;"></div>
    <!--CREATE REQUEST BUTTON: END -->

    <!--FILTER: BEGIN -->
    <div style="margin: 5px;">
        <div>
            <div style="float: left; height: 35px; margin-right: 10px;">
                <div style="float: left; width: 110px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="date-created-filter">
                        Date Created
                    </label>
                </div>
                <div style="float: left;">
                    <input id="date-created-filter" class="bu-form-control" style="width:180px"/>
                </div>
            </div>
            <div style="float: left; height: 35px; margin-right: 10px;">
                <div style="float: left; width: 110px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="status-filter">
                        Status
                    </label>
                </div>
                <div style="float: left;">
                    <div id="status-filter" class="bu-form-control" style="width:180px"></div>
                </div>
            </div>
            <div style="float: left; height: 35px; margin-right: 10px;">
                <div style="float: left; width: 110px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="mode-filter">
                        Type
                    </label>
                </div>
                <div style="float: left;">
                    <div id="mode-filter" class="bu-form-control" style="width:180px"></div>
                </div>
            </div>
            <div style="float: left; height: 35px; margin-right: 10px;">
                <div style="float: left; width: 210px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="TravelBarcode">
                        Travel/Buddy Barcode
                    </label>
                </div>
                <div style="float: left;">
                    <div style="width:180px;"><input id="TravelBarcode" class="bu-form-control" style="width:100%; height: 26px; border-radius: 4px;"/></div>
                </div>
            </div>
        </div>
        <div style="clear: both;">
            <div style="float: left; height: 35px; margin-right: 10px; margin-bottom: 15px;">
                <div style="float: left; width: 110px; margin-right: 10px; visibility: hidden;">
                    Invisible text
                </div>
                <div style="float: left;">
                    <button id="filterGatePassRequestButton" class="k-button" style="width: 180px; width: 180px; padding-left: 5px; background-color: green; border: none; font-size: 17px; font-weight: 600; color: #000000;" onclick="RefreshRequestGrid()">
                        <span class="k-icon k-i-search" style="margin-right: 7px; text-align:left;"></span><span>Search</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!--FILTER: END -->

    <!--DETAILS PAGE GRID: BEGIN -->
    <div id="traveltag-grid" style="clear: both; padding-top: 5px;">
</div>

<!--CREATE NEW TRAVEL TAG PAGE: BEGIN -->
<div id="createNewTag" hidden="hidden">
    <div style="height: 630px; max-height: 630px; overflow: auto; ">
        <div style="float: left; width: 25%; margin-right: 10px;">
            <div style="height: 35px; margin-top: 20px;">
                <div style="float: left; width: 145px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="job-quantity-text">Job quantity</label>
                </div>
                <div style="float: left;">
                    <input class="k-textbox" id="job-quantity-text" name="jobQuantity" style="width:200px;" type="text" value="0">
                </div>
                <div style="float: left;">
                    <span id="job-quantity-requried-sign" style="margin-left: 5px; color: Red;">*</span>
                </div>
            </div>
            <div style="clear: both; height: 35px;">
                <div style="float: left; width: 145px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="weight-text">
                        Weight
                    </label>
                </div>
                <div style="float: left;">
                    <input class="k-textbox" id="weight-text" name="Weight" style="width:200px;" type="text" value="0">
                </div>
                <div style="float: left;">
                    <span style="margin-left: 5px; color: Red;">*</span>
                </div>
            </div>
            <div style="clear: both; height: 35px;">
                <div style="float: left; width: 145px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="trolly-number-text">
                        Trolly No.
                    </label>
                </div>
                <div style="float: left;">
                    <input class="k-textbox" id="trolly-number-text" name="Weight" style="width:200px;" type="text" value="">
                </div>
                <div style="float: left;">
                    <span style="margin-left: 5px; color: Red;">*</span>
                </div>
            </div>
            <div style="clear: both; height: 35px;">
                <div style="float: left; width: 145px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="planned-machine-text">
                        Planned Machine
                    </label>
                </div>
                <div style="float: left;">
                    <input class="k-textbox" id="planned-machine-text" name="Weight" style="width:200px;" type="text" value="">
                </div>
                <div style="float: left;">
                    <span style="margin-left: 5px; color: Red;">*</span>
                </div>
            </div>
            <div style="clear: both; height: 35px;">
                <div style="float: left; width: 145px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="planned-machine-text">
                        Planned Time
                    </label>
                </div>
                <div style="float: left;" id="planned-date-cl">
                    <input class="bu-form-control" style="width:200px" id="planned-date">
                </div>
                <div style="float: left;">
                    <span style="margin-left: 5px; color: Red;">*</span>
                </div>
            </div>
            <div style="clear: both; height: 35px;">
                <div style="float: left; width: 140px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="color-text-i">
                        Color
                    </label>
                </div>
                <div style="float: left;">
                    <label id="color-text-i" style="font-size: 20px; font-weight: 600; margin-top: -4px; margin-left: 6px; color: #00695c;"></label><label id="color-id-i" hidden="hidden"></label>
                </div>
            </div>
        </div>
        <div style="float: left; width: 25%; margin-right: 10px;">
            <div style="height: 35px; margin-top: 20px;">
                <div style="float: left; width: 140px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="allocation-date">Allocation Date</label>
                </div>
                <div style="float: left;">
                    <input id="allocation-date" class="bu-form-control" style="width:180px"/>
                </div>
            </div>
            <div style="clear: both; height: 35px;">
                <div style="float: left; width: 140px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="receiver-epf-text">EPF</label>
                </div>
                <div style="float: left;">
                    <input class="k-textbox" id="receiver-epf-text" name="receiver-epf-text" style="width:200px;" type="text" value="">
                </div>
            </div>
            <div style="clear: both; height: 35px;">
                <div style="float: left; width: 140px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="color-code-dropdown">Priority Color Code</label>
                </div>
                <div style="float: left;">
                    <input id="color-code-dropdown" class="bu-form-control" style="width:180px"/>
                </div>
            </div>
            <div style="height: 35px;">
            </div>
            <div style="height: 35px;">
                <div style="float: left; width: 140px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="remarks-text">
                        Remarks
                    </label>
                </div>
                <div style="float: left; margin-right: 10px;">
                    <textarea class="k-textbox" cols="20" id="remarks-text" name="gpRemarks" rows="2" style="width:200px;resize: none;"></textarea>
                </div>
            </div>
        </div>
        <div style="float: left; width: 20%; margin-right: 10px; margin-top: 10px;">
            <div id="current-quantitiy-text" style="height: 45%; margin-top: 20px; text-align: center; font-size: 100px; color: #D32F2F; height: 100px; font-weight: 600;">
                0
            </div>
            <div id="remaining-quantitiy-text" style="height: 45%; margin-top: 20px; text-align: center; font-size: 45px; height: 100px; font-weight: 600;">
                0
            </div>
        </div>
        <div style="border: #ffffff63 solid 2px;">
            <div style="float: left; width: 25%; margin-right: 10px;">
                <div style="height: 35px; margin-top: 20px;">
                    <div style="float: left; width: 140px; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label for="style-label" class="travel-detail-text">Style :</label>
                    </div>
                    <div style="float: left;">
                        <label id="style-label" class="travel-detail-label travel-detail-text" style="width:180px"></label>
                    </div>
                </div>
                <div style="height: 35px; margin-top: 20px;">
                    <div style="float: left; width: 140px; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label for="shedule-label" class="travel-detail-text">Shedule :</label>
                    </div>
                    <div style="float: left;">
                        <label id="shedule-label" class="travel-detail-label travel-detail-text" style="width:180px"></label>
                    </div>
                </div>
                <div style="height: 35px; margin-top: 20px;">
                    <div style="float: left; width: 140px; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label for="zfeature-label" class="travel-detail-text">Z-Feature :</label>
                    </div>
                    <div style="float: left;">
                        <label id="zfeature-label" class="travel-detail-label travel-detail-text" style="width:180px"></label>
                    </div>
                </div>
                <div style="height: 35px; margin-top: 20px;">
                    <div style="float: left; width: 140px; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label for="quantiity-label" class="travel-detail-text">Quantitiy :</label>
                    </div>
                    <div style="float: left;">
                        <label id="quantiity-label" class="travel-detail-label travel-detail-text" style="width:180px"></label>
                    </div>
                </div>
            </div>
        </div>
        <div style="clear:both;"></div>
        <div style="clear: both;">
            <h2 style="font-weight: bold; font-size: 30px; margin-top: -20px;">
                Items
            </h2>
        </div>
        <div>
            <div style="clear: both; height: 35px;">
                <div style="float: left; width: 180px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="bag-barcode-text" style="margin-top: 3px; font-size: 17px;">
                        Scan Bag Barcode
                    </label>
                </div>
                <div style="float: left;">
                    <input class="k-textbox" id="bag-barcode-text" name="bag-barcode-text" style="width:200px; margin-right: 5px; font-size: 16px;" type="text" value="">
                    <button id="open-request-item-window-button" class="k-button button-add" style="margin-right: 5px;" onclick="allocateFromBagBarcode()">
                        <span class="k-icon k-i-plus" style="margin-right: 7px;"></span><span>Add (F5)</span>
                    </button>
                    <button id="open-split-item-window-button" class="k-button button-split-add" style="margin-right: 5px;" onclick="openAddItemWindow()">
                        <span class="k-icon k-i-plus" style="margin-right: 7px;"></span><span>Split and Add (F6)</span>
                    </button>
                    <button id="open-request-expand-window-button" class="k-button other-buttons" style="margin-left: 2px; width: 32px;" onclick="openExandTable()">
                        <span class="k-icon k-i-full-screen" style="margin-right: 5px;"></span><span></span>
                    </button>
                </div>
                <div style="float: left; margin-top: 6px; margin-right: 10px; text-align: right; font-weight: bold; width: 53%; font-size: 12px;" hidden="hidden">
                    <div style="float: left; width: 11%; margin-right: 10px; text-align: right; font-weight: bold;" hidden="hidden">
                        <label id="last-barcode-txt" hidden="hidden"></label>
                    </div>
                    <div style="float: left; width: 11%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="style-text"></label><label id="style-id" hidden="hidden"></label>
                    </div>
                    <div style="float: left; width: 11%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="shedule-text"></label><label id="shedule-id" hidden="hidden"></label>
                    </div>
                    <div style="float: left; width: 11%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="po-text"></label><label id="po-id" hidden="hidden"></label>
                    </div>
                    <div style="float: left; width: 11%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="z-feature-text"></label>
                    </div>
                    <div style="float: left; width: 20%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="color-text"></label><label id="color-id" hidden="hidden"></label>
                    </div>
                    <div style="float: left; width: 7%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="bag-quantity-text" hidden="hidden"></label><label id="unallocated-text"></label><label id="allocated-text" hidden="hidden"></label>
                    </div>
                    <div style="float: left; margin-left: 20px; text-align: right; font-weight: bold;">
                        <label id="deliverdate-text"></label>
                    </div>
                </div>
                <div style="float: left; margin-top: 6px; margin-right: 10px; text-align: right; font-weight: bold; width: 53%;" hidden="hidden">
                    <div style="float: left; width: 15%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="size-id" hidden="hidden"></label>
                    </div>
                    <div style="float: left; width: 15%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="seq-id" hidden="hidden"></label>
                    </div>
                    <div style="float: left; width: 15%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="wf-id" hidden="hidden"></label>
                        <label id="wfInst-id" hidden="hidden"></label>
                    </div>
                    <div style="float: left; width: 15%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="dep-id" hidden="hidden"></label>
                    </div>
                    <div style="float: left; width: 15%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="l3-id" hidden="hidden"></label>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- REQUEST ITEMS GRID: BEGIN -->
        <div id="bag-barcode-details-table" style="margin-top: 5px; margin-bottom: 5px; width: 99%; height: 37%;">   
            <!--END: Remove Request item window -->
            <!-- REQUEST ITEMS GRID: END -->
        </div>
        <div style="height: 50px"></div>
    </div>
    <div style="clear: both; height: 35px; margin-top: 20px; position: absolute; top: 10; bottom: 0; height: 7%;">
        <div id="createGPWaitingDiv" style="display: none;">
            <span>
            </span> <span style="margin-left: 5px;">
                Saving...
            </span>
        </div>
        <div style="float: left; margin-right: 10px;">
            <input id="gate-pass-request-create-button" type="button" class="k-button button-done" value="Create" style="width: 180px; margin-right: 20px !important" onclick="saveRequest()">
        </div>
        <div style="float: left; margin-right: 10px;">
            <input id="gate-pass-reset-cancel-button" type="button" class="k-button button-reset" value="Reset" style="width: 180px; margin-right: 20px !important" onclick="resetRequest()">
        </div>
        <div style="float: left; margin-right: 10px;">
            <input id="gate-pass-request-cancel-button" type="button" class="k-button button-cancel" value="Cancel" style="width: 180px; margin-right: 20px !important" onclick="cancelRequest()">
        </div>
    </div>
</div>
<!--CREATE NEW PASS PAGE: END -->

<!--CREATE NEW  OUT SOURCE TAG PAGE: START -->
<div id="createNewOutSourceTag" hidden="hidden">
    <div style="height: 640px; max-height: 640px; overflow: auto; ">
        <div style="float: left; width: 25%; margin-right: 10px;">
            <div style="height: 35px; margin-top: 20px;">
                <div style="float: left; width: 145px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="job-quantity-text-o">Job quantity</label>
                </div>
                <div style="float: left;">
                    <input class="k-textbox" id="job-quantity-text-o" name="jobQuantity" style="width:200px;" type="text" value="0">
                </div>
                <div style="float: left;">
                    <span id="job-quantity-requried-sign" style="margin-left: 5px; color: Red;">*</span>
                </div>
            </div>
            <div style="clear: both; height: 35px;">
                <div style="float: left; width: 145px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="weight-text-o">
                        Weight
                    </label>
                </div>
                <div style="float: left;">
                    <input class="k-textbox" id="weight-text-o" name="Weight" style="width:200px;" type="text" value="0">
                </div>
                <div style="float: left;">
                    <span style="margin-left: 5px; color: Red;">*</span>
                </div>
            </div>
            <div style="clear: both; height: 35px;">
                <div style="float: left; width: 145px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="trolly-number-text-o">
                        Trolly No.
                    </label>
                </div>
                <div style="float: left;">
                    <input class="k-textbox" id="trolly-number-text-o" name="Weight" style="width:200px;" type="text" value="">
                </div>
                <div style="float: left;">
                    <span style="margin-left: 5px; color: Red;">*</span>
                </div>
            </div>
            <div style="clear: both; height: 35px;">
                <div style="float: left; width: 145px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="planned-machine-text-o">
                        Planned Machine
                    </label>
                </div>
                <div style="float: left;">
                    <input class="k-textbox" id="planned-machine-text-o" name="Weight" style="width:200px;" type="text" value="">
                </div>
                <div style="float: left;">
                    <span style="margin-left: 5px; color: Red;">*</span>
                </div>
            </div>
            <div style="clear: both; height: 35px;">
                <div style="float: left; width: 145px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="planned-date">
                        Planned Time
                    </label>
                </div>
                <div style="float: left;" id="planned-date-cl-o">
                    <input class="bu-form-control" style="width:200px" id="planned-date-o">
                </div>
                <div style="float: left;">
                    <span style="margin-left: 5px; color: Red;">*</span>
                </div>
            </div>
            <div style="clear: both; height: 35px;">
                <div style="float: left; width: 140px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="color-text-i-o">
                        Color
                    </label>
                </div>
                <div style="float: left;">
                    <label id="color-text-i-o" style="font-size: 20px; font-weight: 600; margin-top: -4px; margin-left: 6px; color: #00695c;"></label><label id="color-id-i" hidden="hidden"></label>
                </div>
            </div>
        </div>
        <div style="float: left; width: 25%; margin-right: 10px;">
            <div style="height: 35px; margin-top: 20px;">
                <div style="float: left; width: 140px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="allocation-date-o">Allocation Date</label>
                </div>
                <div style="float: left;">
                    <input id="allocation-date-o" class="bu-form-control" style="width:180px"/>
                </div>
            </div>
            <div style="clear: both; height: 35px;">
                <div style="float: left; width: 140px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="receiver-epf-text-o">EPF</label>
                </div>
                <div style="float: left;">
                    <input class="k-textbox" id="receiver-epf-text-o" name="receiver-epf-text" style="width:200px;" type="text" value="">
                </div>
            </div>
            <div style="clear: both; height: 35px;">
                <div style="float: left; width: 140px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="color-code-dropdown-o">Priority Color Code</label>
                </div>
                <div style="float: left;">
                    <input id="color-code-dropdown-o" class="bu-form-control" style="width:180px"/>
                </div>
            </div>
            <div style="height: 35px;">
            </div>
            <div style="height: 35px;">
                <div style="float: left; width: 140px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="remarks-text-o">
                        Remarks
                    </label>
                </div>
                <div style="float: left; margin-right: 10px;">
                    <textarea class="k-textbox" cols="20" id="remarks-text-o" name="gpRemarks" rows="2" style="width:200px;resize: none;"></textarea>
                </div>
            </div>
        </div>
        <div style="float: left; width: 20%; margin-right: 10px; margin-top: 10px;">
            <div id="current-quantitiy-text-o" style="height: 45%; margin-top: 20px; text-align: center; font-size: 100px; color: #D32F2F; height: 100px; font-weight: 600;">
                0
            </div>
            <div id="remaining-quantitiy-text-o" style="height: 45%; margin-top: 20px; text-align: center; font-size: 45px; height: 100px; font-weight: 600;">
                0
            </div>
        </div>
        <div style="border: #ffffff63 solid 2px;">
            <div style="float: left; width: 25%; margin-right: 10px;">
                <div style="height: 35px; margin-top: 20px;">
                    <div style="float: left; width: 140px; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label for="style-label-o" class="travel-detail-text">Style :</label>
                    </div>
                    <div style="float: left;">
                        <label id="style-label-o" class="travel-detail-label travel-detail-text" style="width:180px"></label>
                    </div>
                </div>
                <div style="height: 35px; margin-top: 20px;">
                    <div style="float: left; width: 140px; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label for="shedule-label-o" class="travel-detail-text">Shedule :</label>
                    </div>
                    <div style="float: left;">
                        <label id="shedule-label-o" class="travel-detail-label travel-detail-text" style="width:180px"></label>
                    </div>
                </div>
                <div style="height: 35px; margin-top: 20px;">
                    <div style="float: left; width: 140px; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label for="zfeature-label-o" class="travel-detail-text">Z-Feature :</label>
                    </div>
                    <div style="float: left;">
                        <label id="zfeature-label-o" class="travel-detail-label travel-detail-text" style="width:180px"></label>
                    </div>
                </div>
                <div style="height: 35px; margin-top: 20px;">
                    <div style="float: left; width: 140px; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label for="size-label-o" class="travel-detail-text">Size :</label>
                    </div>
                    <div style="float: left;">
                        <label id="size-label-o" class="travel-detail-label travel-detail-text" style="width:180px"></label>
                    </div>
                </div>
                <div style="height: 35px; margin-top: 20px;">
                    <div style="float: left; width: 140px; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label for="quantiity-label-o" class="travel-detail-text">Quantitiy :</label>
                    </div>
                    <div style="float: left;">
                        <label id="quantiity-label-o" class="travel-detail-label travel-detail-text" style="width:180px"></label>
                    </div>
                </div>
            </div>
        </div>
        <div style="clear:both;"></div>
        <div style="clear: both;">
            <h2 style="font-weight: bold; font-size: 30px; margin-top: -20px;">
                Items
            </h2>
        </div>
        <div>
            <div style="clear: both; height: 35px;">
                <div style="float: left; width: 280px; margin-right: 10px; text-align: right; font-weight: bold;">
                    <label for="bag-barcode-text-o" style="margin-top: 3px; font-size: 17px;">
                        Scan Bag Barcode and Qty
                    </label>
                </div>
                <div style="float: left;">
                    <input class="k-textbox" id="bag-barcode-text-o" name="bag-barcode-text" style="width:200px; margin-right: 5px; font-size: 16px;" type="text" value="">
                    <input class="k-textbox" id="allocated-qty-from-bag-o" name="qty" style="width: 81px; font-weight: 1000; font-size: 16px; color: #B71C1C; margin-right: 5px;" type="text" value="0">
                    <button id="open-request-item-window-button-o" class="k-button button-add" style="margin-right: 5px;" onclick="allocateFromBagBarcodeOutSource()">
                        <span class="k-icon k-i-plus" style="margin-right: 7px;"></span><span>Add (F9)</span>
                    </button>
                    <button id="open-request-expand-window-button-o" class="k-button other-buttons" style="margin-left: 2px; width: 32px;" onclick="openExandTableOutSource()">
                        <span class="k-icon k-i-full-screen" style="margin-right: 5px;"></span><span></span>
                    </button>
                </div>
                <div style="float: left; margin-top: 6px; margin-right: 10px; text-align: right; font-weight: bold; width: 53%; font-size: 12px;" hidden="hidden">
                    <div style="float: left; width: 11%; margin-right: 10px; text-align: right; font-weight: bold;" hidden="hidden">
                        <label id="last-barcode-txt-o" hidden="hidden"></label>
                    </div>
                    <div style="float: left; width: 11%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="style-text-o"></label><label id="style-id-o" hidden="hidden"></label>
                    </div>
                    <div style="float: left; width: 11%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="shedule-text-o"></label><label id="shedule-id-o" hidden="hidden"></label>
                    </div>
                    <div style="float: left; width: 11%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="po-text-o"></label><label id="po-id-o" hidden="hidden"></label>
                    </div>
                    <div style="float: left; width: 11%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="z-feature-text-o"></label>
                    </div>
                    <div style="float: left; width: 20%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="color-text-o"></label><label id="color-id-o" hidden="hidden"></label>
                    </div>
                    <div style="float: left; width: 20%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="size-text-o"></label>
                    </div>
                    <div style="float: left; width: 7%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="bag-quantity-text-o" hidden="hidden"></label><label id="unallocated-text-o"></label><label id="allocated-text-o" hidden="hidden"></label>
                    </div>
                    <div style="float: left; margin-left: 20px; text-align: right; font-weight: bold;">
                        <label id="deliverdate-text-o"></label>
                    </div>
                </div>
                <div style="float: left; margin-top: 6px; margin-right: 10px; text-align: right; font-weight: bold; width: 53%;" hidden="hidden">
                    <div style="float: left; width: 15%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="size-id-o" hidden="hidden"></label>
                    </div>
                    <div style="float: left; width: 15%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="seq-id-o" hidden="hidden"></label>
                    </div>
                    <div style="float: left; width: 15%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="wf-id-o" hidden="hidden"></label>
                        <label id="wfInst-id-o" hidden="hidden"></label>
                    </div>
                    <div style="float: left; width: 15%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="dep-id-o" hidden="hidden"></label>
                    </div>
                    <div style="float: left; width: 15%; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label id="l3-id-o" hidden="hidden"></label>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- REQUEST ITEMS GRID: BEGIN -->
        <div id="bag-barcode-details-table-o" style="margin-top: 5px; margin-bottom: 5px; width: 99%; height: 37%;">   
            <!--END: Remove Request item window -->
            <!-- REQUEST ITEMS GRID: END -->
        </div>
        <div style="height: 50px"></div>
    </div>
    <div style="clear: both; height: 35px; margin-top: 30px; position: absolute; top: 10; bottom: 0; height: 7%;">
        <div id="createGPWaitingDiv-o" style="display: none;">
            <span>
            </span> <span style="margin-left: 5px;">
                Saving...
            </span>
        </div>
        <div style="float: left; margin-right: 10px;">
            <input id="gate-pass-request-create-button-o" type="button" class="k-button button-done" value="Create" style="width: 180px; margin-right: 20px !important" onclick="saveRequestOutSource()">
        </div>
        <div style="float: left; margin-right: 10px;">
            <input id="gate-pass-request-reset-button-o" type="button" class="k-button button-reset" value="Reset" style="width: 180px; margin-right: 20px !important" onclick="resetRequest()">
        </div>
        <div style="float: left; margin-right: 10px;">
            <input id="gate-pass-request-cancel-button-o" type="button" class="k-button button-cancel" value="Cancel" style="width: 180px; margin-right: 20px !important" onclick="cancelRequest()">
        </div>
    </div>
</div>
<!--CREATE NEW  OUT SOURCE TAG PAGE: END -->

<!--CREATE NEW TRAVEL TAG PAGE: BEGIN -->
<div id="manageTag" hidden="hidden">
    <div style="height: 630px; max-height: 630px; overflow: auto; ">
        
    </div>
    <div style="clear: both; height: 35px; margin-top: 20px; position: absolute; top: 10; bottom: 0; height: 7%;">
        <div id="createGPWaitingDiv" style="display: none;">
            <span>
            </span> <span style="margin-left: 5px;">
                Saving...
            </span>
        </div>
        <div style="float: left; margin-right: 10px;">
            <input id="gate-pass-request-create-button" type="button" class="k-button button-done" value="Create" style="width: 180px; margin-right: 20px !important" onclick="">
        </div>
        <div style="float: left; margin-right: 10px;">
            <input id="gate-pass-request-cancel-button" type="button" class="k-button button-reset" value="Reset" style="width: 180px; margin-right: 20px !important" onclick="">
        </div>
        <div style="float: left; margin-right: 10px;">
            <input id="gate-pass-request-cancel-button" type="button" class="k-button button-cancel" value="Cancel" style="width: 180px; margin-right: 20px !important" onclick="">
        </div>
    </div>
</div>
<!--CREATE NEW PASS PAGE: END -->

<!--ADD ITEMS PAGE: BEGIN -->
<div id="split-and-allocate" hidden="hidden">
    <div style="overflow: auto; min-height: 90px;">
        <!--FILTER: BEGIN -->
        <div style="margin: 5px;">
            <div>
                <div style="float: left; height: 35px; margin-right: 10px;">
                    <div style="float: left; width: 170px; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label for="allocation-quantity-text">
                            Allocate Quantity
                        </label>
                    </div>
                    <div style="float: left;">
                        <input class="k-textbox" id="allocation-quantity-text" name="bag-barcode-text" style="width:200px; margin-right: 5px;" type="text" value="">
                    </div>
                    <div style="float: left;">
                        <label id="bag-quantity" style="margin-left: 5px; color: #f50000;font-size: 16px; margin-top: 3px;"></label>
                    </div>
                </div>
                <div style="float: left; height: 35px; margin-right: 10px;">
                    <div style="float: left; width: 170px; margin-right: 10px; text-align: right; font-weight: bold;">
                        <label for="ModeSelect">
                            Mode
                        </label>
                    </div>
                    <div style="float: left;">
                        <div id="ModeSelect" class="bu-form-control" style="width:180px"></div>
                    </div>
                </div>
                <div style="float: left; height: 35px; margin-right: 10px;">
                    <div style="float: left; width: 170px; margin-right: 8px; text-align: right; font-weight: bold; padding-left: 3px;">
                        <button id="open-request-item-window-button" class="k-button" style="margin-right: 5px;" onclick="startScanBarcodes()">
                            <span class="k-icon k-i-plus" style="margin-right: 7px;"></span><span>Start Scan</span>
                        </button>
                    </div>
                    <div style="float: left;">
                        <input class="k-textbox" id="allocation-barcode-text" name="bag-barcode-text" style="width:200px; margin-right: 5px;" type="text" value="">
                    </div>
                </div>
                <div style="float: left; height: 35px; margin-right: 10px;">
                    <div style="float: left;">
                        <label id="allocation-barcode-count" style="margin-top: 5px; font-size: 15px; font-weight: bold;"></label>
                        <label id="allocation-barcode-mode-text" style="margin-top: 5px; color: #4CAF50; font-size: 15px; font-weight: bold; margin-left: 6px;" hidden="hidden">Success</label>
                    </div>
                </div>
            </div>
        </div>
        <div style="margin-top: 5px;"></div>
    </div>
    <div id="barcode-pool-table" style="margin-top: 5px; margin-bottom: 5px; width: 99%; height: 350px !important;">   
            <!--END: Remove Request item window -->
            <!-- REQUEST ITEMS GRID: END -->
    </div>
    <div style="margin-top: 5px;"></div>
    <div style="clear: both; height: 35px; position: absolute; top: 10; bottom: 0; height: 7%; margin-bottom: 25px !important;">
        <div id="createGPWaitingDiv" style="display: none;">
            <span style="margin-left: 5px;">
                Saving...
            </span>
        </div>
        <div style="float: left; margin-right: 10px;">
            <input id="split-add-button" type="button" class="k-button" value="Add" style="width: 70px;" onclick="splitandAdd()">
        </div>
        <div style="float: left; margin-right: 10px;">
            <input id="split-cancel-button" type="button" class="k-button" value="Cancel" style="width: 70px;" onclick="splitCancel()">
        </div>
    </div>
    <div style="margin-top: 5px;"></div>
    
    <!-- BARCODE OOL TABLE: START -->
    <div id="barcode-pool-table-data" hidden="hidden">
    </div>
    <!-- BARCODE OOL TABLE: END -->
</div>
<!--ADD ITEMS PAGE: END -->

<!--PRINT: START-->
<div id="printpdf" hidden="hidden"> <!-- hidden="hidden" -->
    <div id="example">
        <div class="box wide hidden-on-narrow">
            <div style="height: 35px; margin-top: 2px;">
                <div style="float: left; width: 120px; margin-right: 10px; margin-left: 4px; text-align: left; font-weight: bold;">
                    <label for="return">Select Page Size</label>
                </div>
                <div style="float: left;">
                    <select id="paper" style="width: 100px;">
                        <option value="size-a4" selected>A4</option>
                        <option value="size-letter">Letter</option>
                        <option value="size-executive">Executive</option>
                    </select>
                </div>
                <div style="float: left;">
                    <span id="approvers-requried-sign" style="margin-left: 5px; color: Red;">
                        *
                    </span>
                </div>
                <div style="float: left;  margin-left: 20px; text-align: left; font-weight: bold;">
                    <button class="export-pdf k-button" onclick="getPDF('.pdf-page')">Export</button>
                </div>
            </div>
        </div>

        <div class="page-container hidden-on-narrow">
            <div class="pdf-page size-a4">
                <div class="inner-page">
                    <div class="pdf-header">
                        <div class="row">
                        <span class="company-logo">
                            <img src="../images/logo.png" style="width: 80px; margin-top: -14px;"/>
                        </span>
                        <span style="margin-left: 20px; font-size: 17px; font-weight: 600;" id="tag-header"></span>
                        <span style="margin-left: 20px; font-size: 24px; font-weight: 600; padding-left: 10px; padding-right: 10px; padding-top: 3px; background: #66bb6a2b; padding-bottom: 3px;" id="factory-h"></span>
                        <span class="invoice-number barcode-text" style="margin-top: 13px; margin-top: -10px; margin-right: -7px; font-size: 13px;" id="travel-barcode"></span>
                        <div>
                    </div>
                    <div class="pdf-footer">
                        <p>
                            <label style="font-size: 9px;" id="time-stamp"></label>
                        </p>
                    </div>
                    <div class="row" id="barcodeDetails" style="margin-right: -7px;">
                        <table class="tg" style="width:100%">
                            <thead>
                                <tr>
                                    <th class="tg-o4nv" colspan="8" style="background-color: #a9aeaed9; !important"><span style="background-color:rgba(255, 255, 255, 0)">Job Order Travel Tag Information</span></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="tg-asgn">Purchase Order</td>
                                    <td class="tg-7zrl" id="purchase-order-p"></td>
                                    <td class="tg-asgn">Job Quantity</td>
                                    <td class="tg-7zrl"id="job-quantity-p"></td>
                                    <td class="tg-asgn">Shedule</td>
                                    <td class="tg-7zrl" id="shedule-no-p"> </td>
                                    <td class="tg-asgn">EPF</td>
                                    <td class="tg-7zrl" id="epf-p"> </td>
                                </tr>
                                <tr>
                                    <td class="tg-asgn">Weight</td>
                                    <td class="tg-7zrl" id="weight-p"></td>
                                    <td class="tg-asgn">Quantity</td>
                                    <td class="tg-7zrl" id="quantity-p"></td>
                                    <td class="tg-asgn">Delivery Date</td>
                                    <td class="tg-7zrl" id="delivery-date-p"></td>
                                    <td class="tg-asgn">Signature</td>
                                    <td class="tg-7zrl" id="signature-p"></td>
                                </tr>
                                <tr>
                                    <td class="tg-asgn">Printed Time</td>
                                    <td class="tg-7zrl" id="printed-time-p"> </td>
                                    <td class="tg-asgn">Printed Date</td>
                                    <td class="tg-7zrl" id="printed-date-p"> </td>
                                    <td class="tg-asgn">Week No.</td>
                                    <td class="tg-7zrl" id="week-no-p"> </td>
                                    <td class="tg-asgn">Trolley No</td>
                                    <td class="tg-7zrl" id="trolly-no-p" style="min-width: 25px;"> </td>
                                </tr>
                                <tr>
                                    <td class="tg-asgn">Customer Name</td>
                                    <td class="tg-8d8j" colspan="3" id="customer-name-p"> </td>
                                    <td class="tg-asgn">Planned Time</td>
                                    <td class="tg-7zrl" id="planned-time-p"> </td>
                                    <td class="tg-asgn">Planned Machine</td>
                                    <td class="tg-7zrl" id="planned-machine-p"> </td>
                                </tr>
                                <tr>
                                    <td class="tg-asgn">Remarks</td>
                                    <td class="tg-8d8j" colspan="5" id="remarks-p"> </td>
                                    <td class="tg-asgn">Supervisor Sign</td>
                                    <td class="tg-7zrl"> </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="row" id="afterwashGarmentDetails" style="margin-right: -7px;">
                        <table class="tg" style="width: 100%;">
                            <thead>
                                <tr>
                                    <th class="tg-o4nv" colspan="6" style="background-color: #a9aeaed9; !important"><span style="background-color:rgba(255, 255, 255, 0)">AWG - After Wash Garment Details</span></th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <td class="tg-asgn">Style</td>
                                    <td class="tg-7zrl" id="style-p"> </td>
                                    <td class="tg-asgn">Factory</td>
                                    <td class="tg-7zrl" id="factory-p"> </td>
                                    <td class="tg-asgn">Color</td>
                                    <td class="tg-7zrl" id="color-p"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="row" id="procestable" style="margin-right: 3px;">
                        <div class="pdf-body" style="margin-right: 3px">
                            <h6 id="items-header"></h6>
                            <div style="font-size: 9px; width: 604px;" id="item-grid-print"></div>
                        </div>
                    </div>
                    <div class="row" id="bagbarcodetable" style="margin-right: 3px;">
                        <div class="pdf-body" style="margin-right: 3px">
                            <h6>USED BAGS</h6>
                            <div style="font-size: 9px; width: 604px;" id="bag-grid-print"></div>
                        </div>
                    </div>
                    <div class="row" id="preocessdetail" style="margin-right: 3px;">
                        <div>
                            <h6>PROCESS TRAVEL TAG</h6>
                        </div>
                        <div>
                            <div>
                                <table class="tg" style="width: 607px !important;">
                                    <thead>
                                        <tr>
                                            <th class="tg-z9yq">Operation No</th>
                                            <th class="tg-z9yq">Operation Description</th>
                                            <th class="tg-z9yq">M/C No.</th>
                                            <th class="tg-z9yq">Planned Start Date/Time</th>
                                            <th class="tg-z9yq">Planned Finish Date/Time</th>
                                            <th class="tg-z9yq" colspan="3">Remarks</th>
                                            <th class="tg-z9yq">Reported Qty</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-yfv8">EPF</td>
                                            <td class="tg-fhtw"> </td>
                                            <td class="tg-fhtw"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-u4qn">Sign</td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-fhtw">Comments</td>
                                            <td class="tg-lyfe" colspan="8"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-8d8j" colspan="9"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-yfv8">EPF</td>
                                            <td class="tg-fhtw"> </td>
                                            <td class="tg-fhtw"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-u4qn">Sign</td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-fhtw">Comments</td>
                                            <td class="tg-lyfe" colspan="8"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-8d8j" colspan="9"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-yfv8">EPF</td>
                                            <td class="tg-fhtw"> </td>
                                            <td class="tg-fhtw"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-u4qn">Sign</td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-fhtw">Comments</td>
                                            <td class="tg-lyfe" colspan="8"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-8d8j" colspan="9"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-yfv8">EPF</td>
                                            <td class="tg-fhtw"> </td>
                                            <td class="tg-fhtw"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-u4qn">Sign</td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-fhtw">Comments</td>
                                            <td class="tg-lyfe" colspan="8"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-8d8j" colspan="9"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-yfv8">EPF</td>
                                            <td class="tg-fhtw"> </td>
                                            <td class="tg-fhtw"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-u4qn">Sign</td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-fhtw">Comments</td>
                                            <td class="tg-lyfe" colspan="8"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-8d8j" colspan="9"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-yfv8">EPF</td>
                                            <td class="tg-fhtw"> </td>
                                            <td class="tg-fhtw"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-u4qn">Sign</td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-fhtw">Comments</td>
                                            <td class="tg-lyfe" colspan="8"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-8d8j" colspan="9"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-yfv8">EPF</td>
                                            <td class="tg-fhtw"> </td>
                                            <td class="tg-fhtw"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-u4qn">Sign</td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-fhtw">Comments</td>
                                            <td class="tg-lyfe" colspan="8"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-8d8j" colspan="9"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-yfv8">EPF</td>
                                            <td class="tg-fhtw"> </td>
                                            <td class="tg-fhtw"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-u4qn">Sign</td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-fhtw">Comments</td>
                                            <td class="tg-lyfe" colspan="8"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-8d8j" colspan="9"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                            <td class="tg-yfv8">EPF</td>
                                            <td class="tg-fhtw"> </td>
                                            <td class="tg-fhtw"> </td>
                                            <td class="tg-lyfe" rowspan="2"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-u4qn">Sign</td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-fhtw">Comments</td>
                                            <td class="tg-lyfe" colspan="8"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-8d8j" colspan="9"> </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div style="margin-top: 15px;">
                                <table class="tg" style="width: 607px !important;">
                                    <thead>
                                        <tr>
                                            <th class="tg-z9yq">Process Control Details</th>
                                            <th class="tg-f6bk" colspan="3">Hold Garment Details</th>
                                            <th class="tg-f6bk" colspan="2">Checked By QC</th>
                                            <th class="tg-z9yq">QC Comments</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <td class="tg-8d8j" rowspan="4"> </td>
                                            <td class="tg-z9yq">Section</td>
                                            <td class="tg-z9yq">Qty</td>
                                            <td class="tg-z9yq">Sign</td>
                                            <td class="tg-z9yq">EPF</td>
                                            <td class="tg-z9yq">Sign</td>
                                            <td class="tg-8d8j" rowspan="4"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div style="margin-top: 15px;">
                                <table class="tg" style="width: 607px !important;">
                                    <thead>
                                        <tr>
                                            <th class="tg-z9yq">Special Finishing Comments</th>
                                            <th class="tg-z9yq">CIF Comments</th>
                                            <th class="tg-z9yq">Date</th>
                                            <th class="tg-z9yq">Section</th>
                                            <th class="tg-z9yq">EPF</th>
                                            <th class="tg-z9yq">Sign</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <td class="tg-8d8j" rowspan="4"> </td>
                                            <td class="tg-8d8j" rowspan="4"> </td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div style="margin-top: 15px;">
                                <table class="tg" style="width: 607px !important;">
                                    <thead>
                                        <tr>
                                            <th class="tg-z9yq">Dispatch&nbsp;&nbsp;&nbsp;In Quantitiy (pcs)</th>
                                            <th class="tg-z9yq">EPF</th>
                                            <th class="tg-z9yq">Sign</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                            <td class="tg-7zrl"> </td>
                                        </tr>
                                        <tr>
                                            <td class="tg-0lax"></td>
                                            <td class="tg-0lax"></td>
                                            <td class="tg-0lax"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="responsive-message"></div>

        <!-- Load Pako ZLIB library to enable PDF compression -->
        <script src="../content/shared/js/pako.min.js"></script>
    </div>
</div>
<!--PRINT: END-->

<!--Expanded Table Window: START-->
<div id="expandedWindow" hidden="hiden">
    <div style="clear:both;">
        <div>
            <h2>
                Items
            </h2>
        </div>
        <!-- REQUEST ITEMS GRID -->
        <div id="expand-items-grid" style="margin-top: 5px;">
        </div>
    </div>
</div>
<!--Expanded Table Window: END-->

<!--Expanded Table Window Out Source: START-->
<div id="expandedWindow-o" hidden="hiden">
    <div style="clear:both;">
        <div>
            <h2>
                Items
            </h2>
        </div>
        <!-- REQUEST ITEMS GRID -->
        <div id="expand-items-grid-o" style="margin-top: 5px;">
        </div>
    </div>
</div>
<!--Expanded Table Window Out Source: END-->

